import{b as z,e as F,V as U,r as _,W as le,f as ae,h as b,o as te,c as oe,L as ne,M as re,k as l,i as e,j as a,p as K,x as D,t as V,$ as P,I as j,n as se,z as de}from"./index-BP30Yz_m.js";import{C as ie}from"./index-DTWQQqpJ.js";import{r as M}from"./verify-D2E6NcQX.js";function ue(){const{t:o}=z();return{pageData:F({columnData:[{label:"颜色编码",prop:"colorCode",width:"auto",fixed:"left"},{label:"颜色名称",prop:"colorName",width:"auto",fixed:"left"},{label:"十六进制颜色",prop:"sixteenDigitColor",width:"auto"},{label:"备注",prop:"remark",width:"auto"},{label:o("operate"),prop:"operate",width:"auto",fixed:"right"}]})}}function ce(o){return U({url:"/bok/fabricColor/list",method:"get",params:o})}function pe(o){return U({url:"/bok/fabricColor",method:"post",data:o})}function me(o){return U({url:"/bok/fabricColor",method:"put",data:o})}function fe(o){return U({url:"/bok/fabricColor/"+o,method:"delete"})}function be(){const o=F({pageSize:10,pageNum:1,colorCode:null,colorName:null,disable:0}),d=F({list:[],total:0}),i=_(),h=()=>{o.pageNum=1,o.pageSize=10,o.disable=0},n=()=>{i.value&&(i.value.resetFields(),i.value.clearValidate());for(const s in o)Object.prototype.hasOwnProperty.call(o,s)&&(o[s]=void 0);h(),p()},p=async()=>{const{rows:s,total:g}=await ce(o);d.list=s,d.total=g};return{formData:o,loadData:p,searchFormRef:i,resetData:n,tableData:d,reloadData:h}}function ge(){const{t:o}=z(),d=F({colorCode:null,colorName:null,sixteenDigitColor:null,remark:null,modifyId:null,modifyName:null,modifyTime:null,notDelete:null,notEdit:null,disable:null,companyId:null}),i=_(),h=F({colorCode:M("颜色编码不能为空"),colorName:M("颜色名称不能为空")}),n=_(""),p=_(!1),s=async()=>new Promise(async(m,v)=>{if(!i.value){v(!1);return}try{await i.value.validate(),d.id?await me(d):await pe(d),N(),le({type:"success",message:o("operate_success")}),m(!0)}catch(C){throw v(C),C}}),g=_(!1),k=(m,v)=>{if(n.value=m&&v?"修改面料色号":"新增面料色号",p.value=!!(m&&v),u(),g.value=!0,v)for(let C in m)Object.prototype.hasOwnProperty.call(m,C)&&(d[C]=m[C]);d.disable=0},u=()=>{i.value&&(i.value.resetFields(),i.value.clearValidate());for(let m in d)d[m]=void 0;d.disable=0},N=()=>{g.value=!1,u()};return{updateFormData:d,updateFormRef:i,updateFormRules:h,submit:s,showHandle:g,openHandle:k,closeHandle:N,title:n,disabled:p}}const S=_([]),I=_();function Ce(o,d){async function i(n){n.id||I.value;const p=S.value.length>0&&S.value.every(u=>u.disable),s=!S.value.length&&n.disable,g=async()=>{await fe(n.id),I.value="",S.value=[],d.$modal.msgSuccess(o("operate_success"))},k=u=>d.$modal.confirm(u).then(g);p?await k(o("delete_tip1")):S.value.length?await k(o("delete_tip2")):s?await k(o("delete_tip4")):await k(o("delete_tip3"))}function h({rowList:n}){S.value=n;const p=n.map(s=>s.id);I.value=p.join(",")}return{deleteHandler:i,select:h,idList:S}}const ye={class:"app-container"},_e={class:"dialog-footer"},De=Object.assign({name:"StyleColor"},{__name:"index",setup(o){const{t:d}=z(),{proxy:i}=de(),{pageData:h}=ue(),{formData:n,tableData:p,loadData:s,searchFormRef:g,resetData:k}=be(),{updateFormData:u,updateFormRef:N,updateFormRules:m,submit:v,openHandle:C,showHandle:$,title:q,closeHandle:L,disabled:he}=ge(),{deleteHandler:Q,select:W,idList:T}=Ce(d,i),R=_(!0),A=_("");ae(()=>{s()});const G=async()=>{try{await v(),setTimeout(()=>{s()},50)}catch(c){throw c}},B=async c=>{await Q(c),setTimeout(()=>{s()},50)};function J(){i.download("bok/fabricColor/export",{...n},`fabricColor${new Date().getTime()}.xlsx`)}return(c,r)=>{const x=b("el-input"),w=b("el-form-item"),f=b("el-col"),X=b("el-checkbox"),y=b("el-button"),H=b("el-row"),O=b("el-form"),E=b("el-tooltip"),Y=b("el-tag"),Z=b("el-dialog");return te(),oe("div",ye,[ne(e(O,{model:l(n),ref_key:"searchFormRef",ref:g,inline:!0,labelSuffix:":"},{default:a(()=>[e(H,{gutter:20},{default:a(()=>[e(f,{lg:4,sm:12,md:12,xs:24},{default:a(()=>[e(w,{label:"颜色编码",prop:"colorCode"},{default:a(()=>[e(x,{modelValue:l(n).colorCode,"onUpdate:modelValue":r[0]||(r[0]=t=>l(n).colorCode=t),placeholder:"请输入颜色编码",clearable:"",onKeyup:K(l(s),["enter"])},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(f,{lg:4,sm:12,md:12,xs:24},{default:a(()=>[e(w,{label:"颜色名称",prop:"colorName"},{default:a(()=>[e(x,{modelValue:l(n).colorName,"onUpdate:modelValue":r[1]||(r[1]=t=>l(n).colorName=t),placeholder:"请输入颜色名称",clearable:"",onKeyup:K(l(s),["enter"])},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(f,{lg:2,sm:12,md:12,xs:24},{default:a(()=>[e(w,{label:"",prop:"delFlag"},{default:a(()=>[e(X,{modelValue:l(n).disable,"onUpdate:modelValue":r[2]||(r[2]=t=>l(n).disable=t),onChange:l(s),"true-label":1,"false-label":0,label:"包含禁用",size:"large"},null,8,["modelValue","onChange"])]),_:1})]),_:1}),e(f,{lg:4,sm:12,md:12,xs:24},{default:a(()=>[e(w,null,{default:a(()=>[e(y,{type:"primary",icon:"Search",onClick:l(s)},{default:a(()=>[D(V(c.$t("query")),1)]),_:1},8,["onClick"]),e(y,{icon:"Refresh",onClick:l(k)},{default:a(()=>[D(V(c.$t("reset")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),[[re,l(R)]]),e(H,{gutter:10,class:"mb10 mt10"},{default:a(()=>[e(f,{span:1.5},{default:a(()=>[e(y,{type:"primary",plain:"",icon:"Plus",onClick:l(C)},{default:a(()=>[D(V(c.$t("add")),1)]),_:1},8,["onClick"])]),_:1}),e(f,{span:1.5},{default:a(()=>[e(y,{type:"danger",plain:"",icon:"Delete",disabled:!l(T).length,onClick:B},{default:a(()=>[D(V(c.$t("delete")),1)]),_:1},8,["disabled"])]),_:1}),e(f,{span:1.5},{default:a(()=>[e(y,{type:"warning",plain:"",icon:"Download",onClick:J,class:"btn-export"},{default:a(()=>[D("导出")]),_:1})]),_:1})]),_:1}),e(ie,{loading:l(P)().loading,onSelect:l(W),ref_key:"tableRef",ref:A,onQueryTable:l(s),showSearch:l(R),"onUpdate:showSearch":r[3]||(r[3]=t=>j(R)?R.value=t:null),"table-key":"fabricColorId",onHandleCurrentChange:l(s),total:l(p).total,showMultipleColumn:"",pageSize:l(n).pageSize,"onUpdate:pageSize":r[4]||(r[4]=t=>l(n).pageSize=t),pageNum:l(n).pageNum,"onUpdate:pageNum":r[5]||(r[5]=t=>l(n).pageNum=t),operateWidth:"100px",tableData:l(p).list,columnData:l(h).columnData,showSummary:!1,showOperate:!1,"show-multiple":!0,"show-multiple-column":!0,showPagination:!0},{operateDefault:a(({data:{row:t}})=>[e(E,{class:"box-item",effect:"dark",content:c.$t("edit"),placement:"top-start"},{default:a(()=>[e(y,{link:"",type:"primary",icon:"Edit",onClick:ee=>l(C)(t,t.id)},null,8,["onClick"])]),_:2},1032,["content"]),e(E,{class:"box-item",effect:"dark",content:c.$t("edit"),placement:"top-start"},{default:a(()=>[e(y,{link:"",type:"primary",icon:"Delete",disabled:!!l(T).length,onClick:ee=>B(t)},null,8,["disabled","onClick"])]),_:2},1032,["content"])]),delFlagDefault:a(({data:{row:t}})=>[e(Y,{type:t.delFlag?"info":"success"},{default:a(()=>[D(V(t.delFlag?"禁用":"正常"),1)]),_:2},1032,["type"])]),_:1},8,["loading","onSelect","onQueryTable","showSearch","onHandleCurrentChange","total","pageSize","pageNum","tableData","columnData"]),e(Z,{title:l(q),modelValue:l($),"onUpdate:modelValue":r[11]||(r[11]=t=>j($)?$.value=t:null),width:"500px","append-to-body":"",onClose:l(L)},{footer:a(()=>[se("div",_e,[e(y,{type:"primary",class:"btn-confirm",loading:l(P)().loading,onClick:G},{default:a(()=>[D(V(c.$t("confirm")),1)]),_:1},8,["loading"]),e(y,{onClick:r[10]||(r[10]=t=>$.value=!1),class:"btn-cancel"},{default:a(()=>[D(V(c.$t("cancel")),1)]),_:1})])]),default:a(()=>[e(O,{ref_key:"updateFormRef",ref:N,"label-position":"left",model:l(u),rules:l(m),"label-suffix":"："},{default:a(()=>[e(H,{gutter:20},{default:a(()=>[e(f,{span:24},{default:a(()=>[e(w,{label:"颜色编码",prop:"colorCode"},{default:a(()=>[e(x,{modelValue:l(u).colorCode,"onUpdate:modelValue":r[6]||(r[6]=t=>l(u).colorCode=t),placeholder:"请输入颜色编码"},null,8,["modelValue"])]),_:1})]),_:1}),e(f,{span:24},{default:a(()=>[e(w,{label:"颜色名称",prop:"colorName"},{default:a(()=>[e(x,{modelValue:l(u).colorName,"onUpdate:modelValue":r[7]||(r[7]=t=>l(u).colorName=t),placeholder:"请输入颜色名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(f,{span:24},{default:a(()=>[e(w,{label:"十六进制颜色",prop:"sixteenDigitColor"},{default:a(()=>[e(x,{modelValue:l(u).sixteenDigitColor,"onUpdate:modelValue":r[8]||(r[8]=t=>l(u).sixteenDigitColor=t),placeholder:"请输入十六进制颜色"},null,8,["modelValue"])]),_:1})]),_:1}),e(f,{span:24},{default:a(()=>[e(w,{label:c.$t("brandInfo.remark"),prop:"remark"},{default:a(()=>[e(x,{modelValue:l(u).remark,"onUpdate:modelValue":r[9]||(r[9]=t=>l(u).remark=t),type:"textarea",clearable:"",placeholder:`${c.$t("input")}${c.$t("brandInfo.remark")} `},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onClose"])])}}});export{De as default};
