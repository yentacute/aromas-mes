import{b as W,e as F,r as f,W as ne,f as re,h as p,o as O,c as q,L as ie,M as ue,k as e,i as t,j as o,p as de,x,t as S,$ as E,I as G,n as ce,s as K,v as pe,F as me,q as he,z as fe}from"./index-BP30Yz_m.js";import{C as be}from"./index-DTWQQqpJ.js";import{l as we,r as _e,u as ye,a as ge,g as ve,d as Ce}from"./warehouse-DqhAX_t8.js";import{r as H}from"./verify-D2E6NcQX.js";function ke(){const{t:l}=W();return{pageData:F({columnData:[{label:l("storeArchives.materialCategoryName"),prop:"materialCategoryName",width:"150",fixed:"left"},{label:l("storeArchives.warehouseCode"),prop:"warehouseCode",width:"150",fixed:"left"},{label:l("storeArchives.warehouseName"),prop:"warehouseName",width:"150"},{label:l("storeArchives.warehouseDescription"),prop:"warehouseDescription",width:"auto"},{label:l("is_disable"),prop:"disable",width:"auto"},{label:l("remark"),prop:"remark",width:"auto"},{label:l("operate"),prop:"operate",width:"150",fixed:"right"}]})}}function De(){const l=F({pageSize:10,pageNum:1,warehouseName:null,disable:0}),a=F({list:[],total:0}),d=f(),g=f([]),n=()=>{l.pageNum=1,l.pageSize=10,l.disable=0},m=()=>{d.value&&(d.value.resetFields(),d.value.clearValidate());for(const i in l)Object.prototype.hasOwnProperty.call(l,i)&&(l[i]=void 0);n(),u()},u=async()=>{const{rows:i,total:b}=await we(l);a.list=i,a.total=b};return{formData:l,loadData:u,searchFormRef:d,resetData:m,tableData:a,reloadData:n,materialCategoryOptions:g,getOption:async()=>{const{data:i}=await _e();g.value=i}}}function Ve(){const{t:l}=W(),a=F({warehouseCode:null,warehouseName:null,warehouseType:null,remark:null,storeGroupId:null,warehouseDescription:null}),d=f(),g=F({warehouseCode:H(l("storeArchives.warehouseCode")+l("cannot_empty")),warehouseName:H(l("storeArchives.warehouseName")+l("cannot_empty")),storeGroupId:H(l("storeArchives.storeGroup")+l("cannot_empty")),warehouseType:H(l("storeArchives.warehouseType")+l("cannot_empty"))}),n=f(""),m=f(!1),u=async()=>new Promise(async(h,w)=>{if(!d.value){w(!1);return}try{await d.value.validate(),a.id?await ye(a):await ge(a),c(),ne({type:"success",message:l("operate_success")}),h(!0)}catch(_){throw w(_),_}}),v=f(!1),i=f(!1),b=async(h,w)=>{if(n.value=i.value?l("check_details"):h&&w?l("edit")+l("storeArchives.warehouse"):l("add")+l("storeArchives.warehouse"),m.value=!!(h&&w),R(),v.value=!0,w){const{data:_}=await ve({id:w});for(let D in _)Object.prototype.hasOwnProperty.call(_,D)&&(a[D]=_[D])}},R=()=>{d.value&&(d.value.resetFields(),d.value.clearValidate());for(let h in a)a[h]=void 0},c=()=>{v.value=!1,i.value=!1,R()};return{updateFormData:a,updateFormRef:d,updateFormRules:g,submit:u,showHandle:v,openHandle:b,closeHandle:c,title:n,disabled:m,handleCheckDetail:h=>{i.value=!0,b(h,h.id)},isDetails:i}}const N=f([]),I=f();function Ne(l,a){async function d(n){n.id||I.value;const m=N.value.length>0&&N.value.every(b=>b.disable),u=!N.value.length&&n.disable,v=async()=>{await Ce({id:n.id}),I.value="",N.value=[],a.$modal.msgSuccess(l("operate_success"))},i=b=>a.$modal.confirm(b).then(v);m?await i(l("delete_tip1")):N.value.length?await i(l("delete_tip2")):u?await i(l("delete_tip4")):await i(l("delete_tip3"))}function g({rowList:n}){N.value=n;const m=n.map(u=>u.id);I.value=m.join(",")}return{deleteHandler:d,select:g,idList:N}}const xe={class:"app-container"},Se={class:"dialog-footer"},Oe=Object.assign({name:"WarehouseIndex"},{__name:"index",setup(l){const{t:a}=W(),{proxy:d}=fe(),{pageData:g}=ke(),{formData:n,tableData:m,loadData:u,searchFormRef:v,resetData:i,materialCategoryOptions:b,getOption:R}=De(),{updateFormData:c,updateFormRef:B,updateFormRules:h,submit:w,openHandle:_,showHandle:D,title:L,handleCheckDetail:Q,closeHandle:M,isDetails:V}=Ve(),{deleteHandler:J,select:X,idList:Ae}=Ne(a,d),T=f(!0),Y=f("");re(()=>{u(),R()});const Z=async()=>{try{await w(),setTimeout(()=>{u()},50)}catch(U){throw U}},ee=async U=>{await J(U),setTimeout(()=>{u()},50)};return(U,r)=>{const A=p("el-input"),C=p("el-form-item"),y=p("el-col"),ae=p("el-checkbox"),k=p("el-button"),$=p("el-row"),P=p("el-form"),z=p("el-tooltip"),te=p("el-tag"),le=p("el-option"),oe=p("el-select"),se=p("el-dialog");return O(),q("div",xe,[ie(t(P,{model:e(n),ref_key:"searchFormRef",ref:v,inline:!0,labelSuffix:":"},{default:o(()=>[t($,{gutter:20},{default:o(()=>[t(y,{lg:5,sm:12,md:12,xs:24},{default:o(()=>[t(C,{label:e(a)("storeArchives.warehouseName"),prop:"warehouseName"},{default:o(()=>[t(A,{modelValue:e(n).warehouseName,"onUpdate:modelValue":r[0]||(r[0]=s=>e(n).warehouseName=s),placeholder:e(a)("storeArchives.warehouseName"),clearable:"",onKeyup:de(e(u),["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1},8,["label"])]),_:1}),t(y,{lg:2,sm:12,md:12,xs:24},{default:o(()=>[t(C,{label:"",prop:"disable"},{default:o(()=>[t(ae,{modelValue:e(n).disable,"onUpdate:modelValue":r[1]||(r[1]=s=>e(n).disable=s),onChange:e(u),"true-label":1,"false-label":0,label:e(a)("include_disable"),size:"large"},null,8,["modelValue","onChange","label"])]),_:1})]),_:1}),t(y,{lg:5,sm:12,md:12,xs:24},{default:o(()=>[t(C,null,{default:o(()=>[t(k,{type:"primary",icon:"Search",onClick:e(u)},{default:o(()=>[x(S(e(a)("query")),1)]),_:1},8,["onClick"]),t(k,{icon:"Refresh",onClick:e(i)},{default:o(()=>[x(S(e(a)("reset")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),[[ue,e(T)]]),t($,{gutter:10,class:"mb10 mt10"},{default:o(()=>[t(y,{span:1.5},{default:o(()=>[t(k,{type:"primary",plain:"",icon:"Plus",onClick:e(_)},{default:o(()=>[x(S(e(a)("add")),1)]),_:1},8,["onClick"])]),_:1})]),_:1}),t(be,{loading:e(E)().loading,onSelect:e(X),ref_key:"tableRef",ref:Y,onQueryTable:e(u),showSearch:e(T),"onUpdate:showSearch":r[2]||(r[2]=s=>G(T)?T.value=s:null),"table-key":"warehouseId",onHandleCurrentChange:e(u),total:e(m).total,showMultipleColumn:"",pageSize:e(n).pageSize,"onUpdate:pageSize":r[3]||(r[3]=s=>e(n).pageSize=s),pageNum:e(n).pageNum,"onUpdate:pageNum":r[4]||(r[4]=s=>e(n).pageNum=s),operateWidth:"100px",tableData:e(m).list,columnData:e(g).columnData,showSummary:!1,showOperate:!1,"show-multiple":!1,"show-multiple-column":!0,showPagination:!0},{operateDefault:o(({data:{row:s}})=>[t(z,{class:"box-item",effect:"dark",content:e(a)("check_details"),placement:"top-start"},{default:o(()=>[t(k,{link:"",type:"primary",icon:"View",onClick:j=>e(Q)(s)},null,8,["onClick"])]),_:2},1032,["content"]),t(z,{class:"box-item",effect:"dark",content:e(a)("edit"),placement:"top-start"},{default:o(()=>[t(k,{link:"",type:"primary",icon:"Edit",disabled:s.notEdit,onClick:j=>e(_)(s,s.id)},null,8,["disabled","onClick"])]),_:2},1032,["content"]),t(z,{class:"box-item",effect:"dark",content:e(a)("delete"),placement:"top-start"},{default:o(()=>[t(k,{link:"",type:"primary",icon:"Delete",disabled:s.notDelete,onClick:j=>ee(s)},null,8,["disabled","onClick"])]),_:2},1032,["content"])]),disableDefault:o(({data:{row:s}})=>[t(te,{type:s.disable?"info":"success"},{default:o(()=>[x(S(s.disable?e(a)("disabled"):e(a)("normal")),1)]),_:2},1032,["type"])]),_:1},8,["loading","onSelect","onQueryTable","showSearch","onHandleCurrentChange","total","pageSize","pageNum","tableData","columnData"]),t(se,{title:e(L),modelValue:e(D),"onUpdate:modelValue":r[10]||(r[10]=s=>G(D)?D.value=s:null),width:"500px","append-to-body":"",onClose:e(M)},{footer:o(()=>[ce("div",Se,[e(V)?pe("",!0):(O(),K(k,{key:0,type:"primary",class:"btn-confirm",loading:e(E)().loading,onClick:Z},{default:o(()=>[x(S(e(a)("confirm")),1)]),_:1},8,["loading"])),t(k,{onClick:e(M),class:"btn-cancel"},{default:o(()=>[x(S(e(V)?e(a)("close"):e(a)("cancel")),1)]),_:1},8,["onClick"])])]),default:o(()=>[t(P,{ref_key:"updateFormRef",ref:B,"label-position":"left",model:e(c),rules:e(h),"label-suffix":"ï¼š"},{default:o(()=>[t($,{gutter:20},{default:o(()=>[t(y,{span:24},{default:o(()=>[t(C,{label:e(a)("storeArchives.warehouseType"),prop:"warehouseType"},{default:o(()=>[t(oe,{modelValue:e(c).warehouseType,"onUpdate:modelValue":r[5]||(r[5]=s=>e(c).warehouseType=s),clearable:"",disabled:e(V)},{default:o(()=>[(O(!0),q(me,null,he(e(b),s=>(O(),K(le,{key:s.materialCategory,label:s.materialCategoryName,value:s.materialCategory},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["label"])]),_:1}),t(y,{span:24},{default:o(()=>[t(C,{label:e(a)("storeArchives.warehouseCode"),prop:"warehouseCode"},{default:o(()=>[t(A,{modelValue:e(c).warehouseCode,"onUpdate:modelValue":r[6]||(r[6]=s=>e(c).warehouseCode=s),disabled:e(V),placeholder:e(a)("input")+e(a)("storeArchives.warehouseCode")},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])]),_:1}),t(y,{span:24},{default:o(()=>[t(C,{label:e(a)("storeArchives.warehouseName"),prop:"warehouseName"},{default:o(()=>[t(A,{modelValue:e(c).warehouseName,"onUpdate:modelValue":r[7]||(r[7]=s=>e(c).warehouseName=s),disabled:e(V),placeholder:e(a)("input")+e(a)("storeArchives.warehouseName")},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])]),_:1}),t(y,{span:24},{default:o(()=>[t(C,{label:e(a)("storeArchives.warehouseDescription"),prop:"warehouseDescription"},{default:o(()=>[t(A,{modelValue:e(c).warehouseDescription,"onUpdate:modelValue":r[8]||(r[8]=s=>e(c).warehouseDescription=s),type:"textarea",clearable:"",disabled:e(V),placeholder:`${e(a)("input")}${e(a)("storeArchives.warehouseDescription")} `},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])]),_:1}),t(y,{span:24},{default:o(()=>[t(C,{label:e(a)("remark"),prop:"remark"},{default:o(()=>[t(A,{modelValue:e(c).remark,"onUpdate:modelValue":r[9]||(r[9]=s=>e(c).remark=s),type:"textarea",clearable:"",disabled:e(V),placeholder:`${e(a)("input")}${e(a)("remark")} `},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onClose"])])}}});export{Oe as default};
