import{V as x,b as T,e as v,r as C,W as ee,f as le,h as g,o as ae,c as te,L as oe,M as de,k as l,i as e,j as a,p as O,x as S,t as F,$ as W,I as K,n as ne,z as ue}from"./index-BP30Yz_m.js";import{C as re}from"./index-DTWQQqpJ.js";import{r as P}from"./verify-D2E6NcQX.js";function pe(p){return x({url:"/bok/fabric/list",method:"get",params:p})}function ie(p){return x({url:"/bok/fabric",method:"post",data:p})}function se(p){return x({url:"/bok/fabric",method:"put",data:p})}function me(p){return x({url:"/bok/fabric/"+p,method:"delete"})}function fe(){const{t:p}=T();return{pageData:v({columnData:[{label:"面料编号",prop:"fabricCode",width:"150",fixed:"left"},{label:"面料名称",prop:"fabricName",width:"150",fixed:"left"},{label:"面料英文名称",prop:"fabricEnName",width:"auto"},{label:"规格",prop:"specification",width:"150"},{label:"织物成分",prop:"component",width:"150"},{label:"面料颜色",prop:"colorId",width:"150"},{label:"标准幅宽",prop:"widthStandard",width:"150"},{label:"标准克重",prop:"weightStandard",width:"150"},{label:"供应商",prop:"supplierId",width:"150"},{label:p("operate"),prop:"operate",width:"150",fixed:"right"}]})}}function be(){const p=v({pageSize:10,pageNum:1,fabricCode:null,fabricName:null,disable:0}),m=v({list:[],total:0}),b=C(),_=()=>{p.pageNum=1,p.pageSize=10,p.disable=0},i=()=>{b.value&&(b.value.resetFields(),b.value.clearValidate());for(const s in p)Object.prototype.hasOwnProperty.call(p,s)&&(p[s]=void 0);_(),c()},c=async()=>{const{rows:s,total:w}=await pe(p);m.list=s,m.total=w};return{formData:p,loadData:c,searchFormRef:b,resetData:i,tableData:m,reloadData:_}}function ce(){const{t:p}=T(),m=v({materialTypeId:null,fabricCode:null,fabricName:null,fabricEnName:null,specification:null,component:null,colorId:null,widthStandard:null,widthLower:null,widthUpper:null,weightStandard:null,weightLower:null,weightUpper:null,customerId:null,brandId:null,customerFabricCode:null,customerFabricName:null,supplierId:null,supplierFabricCode:null,supplierFabricName:null,unitCode:null,unitCodeSale:null,unitWeight:null,safetyStock:null,partsUsed:null,season:null,remark:null,createId:null,createName:null,createTime:null,modifyId:null,modifyName:null,modifyTime:null,notDelete:null,notEdit:null,disable:null,companyId:null}),b=C(),_=v({fabricCode:P("面料编号不能为空"),fabricName:P("面料名称不能为空")}),i=C(""),c=C(!1),s=async()=>new Promise(async(V,k)=>{if(!b.value){k(!1);return}try{await b.value.validate(),m.id?await se(m):await ie(m),I(),ee({type:"success",message:p("operate_success")}),V(!0)}catch(h){throw k(h),h}}),w=C(!1),U=(V,k)=>{if(i.value=V&&k?"修改面料档案":"新增面料档案",c.value=!!(V&&k),d(),w.value=!0,k)for(let h in V)Object.prototype.hasOwnProperty.call(V,h)&&(m[h]=V[h]);m.disable=0},d=()=>{b.value&&(b.value.resetFields(),b.value.clearValidate());for(let V in m)m[V]=void 0;m.disable=0},I=()=>{w.value=!1,d()};return{updateFormData:m,updateFormRef:b,updateFormRules:_,submit:s,showHandle:w,openHandle:U,closeHandle:I,title:i,disabled:c}}const N=C([]),R=C();function Ve(p,m){async function b(i){i.id||R.value;const c=N.value.length>0&&N.value.every(d=>d.disable),s=!N.value.length&&i.disable,w=async()=>{await me(i.id),R.value="",N.value=[],m.$modal.msgSuccess(p("operate_success"))},U=d=>m.$modal.confirm(d).then(w);c?await U(p("delete_tip1")):N.value.length?await U(p("delete_tip2")):s?await U(p("delete_tip4")):await U(p("delete_tip3"))}function _({rowList:i}){N.value=i;const c=i.map(s=>s.id);R.value=c.join(",")}return{deleteHandler:b,select:_,idList:N}}const ge={class:"app-container"},we={class:"dialog-footer"},Ue=Object.assign({name:"Fabric"},{__name:"index",setup(p){const{t:m}=T(),{proxy:b}=ue(),{pageData:_}=fe(),{formData:i,tableData:c,loadData:s,searchFormRef:w,resetData:U}=be(),{updateFormData:d,updateFormRef:I,updateFormRules:V,submit:k,openHandle:h,showHandle:D,title:j,disabled:he}=ce(),{deleteHandler:M,select:q,idList:L}=Ve(m,b),$=C(!0),Q=C("");le(()=>{s()});const A=async()=>{try{await k(),setTimeout(()=>{s()},50)}catch(f){throw f}},z=async f=>{await M(f),setTimeout(()=>{s()},50)};function G(){b.download("bok/fabric/export",{...i},`fabric_${new Date().getTime()}.xlsx`)}return(f,o)=>{const r=g("el-input"),u=g("el-form-item"),n=g("el-col"),J=g("el-checkbox"),y=g("el-button"),E=g("el-row"),H=g("el-form"),B=g("el-tooltip"),X=g("el-tag"),Y=g("el-dialog");return ae(),te("div",ge,[oe(e(H,{model:l(i),ref_key:"searchFormRef",ref:w,inline:!0,labelSuffix:":"},{default:a(()=>[e(E,{gutter:20},{default:a(()=>[e(n,{lg:4,sm:12,md:12,xs:24},{default:a(()=>[e(u,{label:"面料编号",prop:"fabricCode"},{default:a(()=>[e(r,{modelValue:l(i).fabricCode,"onUpdate:modelValue":o[0]||(o[0]=t=>l(i).fabricCode=t),placeholder:"请输入面料编号",clearable:"",onKeyup:O(l(s),["enter"])},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(n,{lg:4,sm:12,md:12,xs:24},{default:a(()=>[e(u,{label:"面料名称",prop:"fabricName"},{default:a(()=>[e(r,{modelValue:l(i).fabricName,"onUpdate:modelValue":o[1]||(o[1]=t=>l(i).fabricName=t),placeholder:"请输入面料名称",clearable:"",onKeyup:O(l(s),["enter"])},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(n,{lg:4,sm:12,md:12,xs:24},{default:a(()=>[e(u,{label:f.$t("brandInfo.english_name"),prop:"brandEnName"},{default:a(()=>[e(r,{modelValue:l(i).brandEnName,"onUpdate:modelValue":o[2]||(o[2]=t=>l(i).brandEnName=t),placeholder:`${f.$t("input")}${f.$t("brandInfo.english_name")} `,clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(n,{lg:2,sm:12,md:12,xs:24},{default:a(()=>[e(u,{label:"",prop:"delFlag"},{default:a(()=>[e(J,{modelValue:l(i).disable,"onUpdate:modelValue":o[3]||(o[3]=t=>l(i).disable=t),onChange:l(s),"true-label":1,"false-label":0,label:"包含禁用",size:"large"},null,8,["modelValue","onChange"])]),_:1})]),_:1}),e(n,{lg:4,sm:12,md:12,xs:24},{default:a(()=>[e(u,null,{default:a(()=>[e(y,{type:"primary",icon:"Search",onClick:l(s)},{default:a(()=>[S(F(f.$t("query")),1)]),_:1},8,["onClick"]),e(y,{icon:"Refresh",onClick:l(U)},{default:a(()=>[S(F(f.$t("reset")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),[[de,l($)]]),e(E,{gutter:10,class:"mb10 mt10"},{default:a(()=>[e(n,{span:1.5},{default:a(()=>[e(y,{type:"primary",plain:"",icon:"Plus",onClick:l(h)},{default:a(()=>[S(F(f.$t("add")),1)]),_:1},8,["onClick"])]),_:1}),e(n,{span:1.5},{default:a(()=>[e(y,{type:"danger",plain:"",icon:"Delete",disabled:!l(L).length,onClick:z},{default:a(()=>[S(F(f.$t("delete")),1)]),_:1},8,["disabled"])]),_:1}),e(n,{span:1.5},{default:a(()=>[e(y,{type:"warning",plain:"",icon:"Download",onClick:G,class:"btn-export"},{default:a(()=>[S("导出")]),_:1})]),_:1})]),_:1}),e(re,{loading:l(W)().loading,onSelect:l(q),ref_key:"tableRef",ref:Q,onQueryTable:l(s),showSearch:l($),"onUpdate:showSearch":o[4]||(o[4]=t=>K($)?$.value=t:null),"table-key":"fabricId",onHandleCurrentChange:l(s),total:l(c).total,showMultipleColumn:"",pageSize:l(i).pageSize,"onUpdate:pageSize":o[5]||(o[5]=t=>l(i).pageSize=t),pageNum:l(i).pageNum,"onUpdate:pageNum":o[6]||(o[6]=t=>l(i).pageNum=t),operateWidth:"100px",tableData:l(c).list,columnData:l(_).columnData,showSummary:!1,showOperate:!1,"show-multiple":!0,"show-multiple-column":!0,showPagination:!0},{operateDefault:a(({data:{row:t}})=>[e(B,{class:"box-item",effect:"dark",content:f.$t("edit"),placement:"top-start"},{default:a(()=>[e(y,{link:"",type:"primary",icon:"Edit",onClick:Z=>l(h)(t,t.id)},null,8,["onClick"])]),_:2},1032,["content"]),e(B,{class:"box-item",effect:"dark",content:f.$t("edit"),placement:"top-start"},{default:a(()=>[e(y,{link:"",type:"primary",icon:"Delete",disabled:!!l(L).length,onClick:Z=>z(t)},null,8,["disabled","onClick"])]),_:2},1032,["content"])]),delFlagDefault:a(({data:{row:t}})=>[e(X,{type:t.delFlag?"info":"success"},{default:a(()=>[S(F(t.delFlag?"禁用":"正常"),1)]),_:2},1032,["type"])]),_:1},8,["loading","onSelect","onQueryTable","showSearch","onHandleCurrentChange","total","pageSize","pageNum","tableData","columnData"]),e(Y,{title:l(j),modelValue:l(D),"onUpdate:modelValue":o[35]||(o[35]=t=>K(D)?D.value=t:null),width:"500px","append-to-body":""},{footer:a(()=>[ne("div",we,[e(y,{type:"primary",class:"btn-confirm",loading:l(W)().loading,onClick:A},{default:a(()=>[S(F(f.$t("confirm")),1)]),_:1},8,["loading"]),e(y,{onClick:o[34]||(o[34]=t=>D.value=!1),class:"btn-cancel"},{default:a(()=>[S(F(f.$t("cancel")),1)]),_:1})])]),default:a(()=>[e(H,{ref_key:"updateFormRef",ref:I,"label-position":"left",model:l(d),rules:l(V),"label-suffix":"："},{default:a(()=>[e(E,{gutter:20},{default:a(()=>[e(n,{span:24},{default:a(()=>[e(u,{label:"物料分类",prop:"materialTypeId"},{default:a(()=>[e(r,{modelValue:l(d).materialTypeId,"onUpdate:modelValue":o[7]||(o[7]=t=>l(d).materialTypeId=t),placeholder:"请输入物料分类ID"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"面料编号",prop:"fabricCode"},{default:a(()=>[e(r,{modelValue:l(d).fabricCode,"onUpdate:modelValue":o[8]||(o[8]=t=>l(d).fabricCode=t),placeholder:"请输入面料编号"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"面料名称",prop:"fabricName"},{default:a(()=>[e(r,{modelValue:l(d).fabricName,"onUpdate:modelValue":o[9]||(o[9]=t=>l(d).fabricName=t),placeholder:"请输入面料名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"面料英文名称",prop:"fabricEnName"},{default:a(()=>[e(r,{modelValue:l(d).fabricEnName,"onUpdate:modelValue":o[10]||(o[10]=t=>l(d).fabricEnName=t),placeholder:"请输入面料英文名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"规格",prop:"specification"},{default:a(()=>[e(r,{modelValue:l(d).specification,"onUpdate:modelValue":o[11]||(o[11]=t=>l(d).specification=t),placeholder:"请输入规格"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"织物成分",prop:"component"},{default:a(()=>[e(r,{modelValue:l(d).component,"onUpdate:modelValue":o[12]||(o[12]=t=>l(d).component=t),placeholder:"请输入织物成分"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"面料颜色",prop:"colorId"},{default:a(()=>[e(r,{modelValue:l(d).colorId,"onUpdate:modelValue":o[13]||(o[13]=t=>l(d).colorId=t),placeholder:"请输入面料颜色"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"标准幅宽",prop:"widthStandard"},{default:a(()=>[e(r,{modelValue:l(d).widthStandard,"onUpdate:modelValue":o[14]||(o[14]=t=>l(d).widthStandard=t),placeholder:"请输入标准幅宽"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"最小幅宽",prop:"widthLower"},{default:a(()=>[e(r,{modelValue:l(d).widthLower,"onUpdate:modelValue":o[15]||(o[15]=t=>l(d).widthLower=t),placeholder:"请输入最小幅宽"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"最大幅宽",prop:"widthUpper"},{default:a(()=>[e(r,{modelValue:l(d).widthUpper,"onUpdate:modelValue":o[16]||(o[16]=t=>l(d).widthUpper=t),placeholder:"请输入最大幅宽"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"标准克重",prop:"weightStandard"},{default:a(()=>[e(r,{modelValue:l(d).weightStandard,"onUpdate:modelValue":o[17]||(o[17]=t=>l(d).weightStandard=t),placeholder:"请输入标准克重"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"最小克重",prop:"weightLower"},{default:a(()=>[e(r,{modelValue:l(d).weightLower,"onUpdate:modelValue":o[18]||(o[18]=t=>l(d).weightLower=t),placeholder:"请输入最小克重"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"最大克重",prop:"weightUpper"},{default:a(()=>[e(r,{modelValue:l(d).weightUpper,"onUpdate:modelValue":o[19]||(o[19]=t=>l(d).weightUpper=t),placeholder:"请输入最大克重"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"专属客户",prop:"customerId"},{default:a(()=>[e(r,{modelValue:l(d).customerId,"onUpdate:modelValue":o[20]||(o[20]=t=>l(d).customerId=t),placeholder:"请输入专属客户"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"默认品牌",prop:"brandId"},{default:a(()=>[e(r,{modelValue:l(d).brandId,"onUpdate:modelValue":o[21]||(o[21]=t=>l(d).brandId=t),placeholder:"请输入默认品牌"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"客户物料编码",prop:"customerFabricCode"},{default:a(()=>[e(r,{modelValue:l(d).customerFabricCode,"onUpdate:modelValue":o[22]||(o[22]=t=>l(d).customerFabricCode=t),placeholder:"请输入客户物料编码"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"客户物料名称",prop:"customerFabricName"},{default:a(()=>[e(r,{modelValue:l(d).customerFabricName,"onUpdate:modelValue":o[23]||(o[23]=t=>l(d).customerFabricName=t),placeholder:"请输入客户物料名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"供应商",prop:"supplierId"},{default:a(()=>[e(r,{modelValue:l(d).supplierId,"onUpdate:modelValue":o[24]||(o[24]=t=>l(d).supplierId=t),placeholder:"请输入供应商"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"供应商物料编码",prop:"supplierFabricCode"},{default:a(()=>[e(r,{modelValue:l(d).supplierFabricCode,"onUpdate:modelValue":o[25]||(o[25]=t=>l(d).supplierFabricCode=t),placeholder:"请输入供应商物料编码"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"供应商物料名称",prop:"supplierFabricName"},{default:a(()=>[e(r,{modelValue:l(d).supplierFabricName,"onUpdate:modelValue":o[26]||(o[26]=t=>l(d).supplierFabricName=t),placeholder:"请输入供应商物料名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"业务单位",prop:"unitCode"},{default:a(()=>[e(r,{modelValue:l(d).unitCode,"onUpdate:modelValue":o[27]||(o[27]=t=>l(d).unitCode=t),placeholder:"请输入业务单位"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"销售单位",prop:"unitCodeSale"},{default:a(()=>[e(r,{modelValue:l(d).unitCodeSale,"onUpdate:modelValue":o[28]||(o[28]=t=>l(d).unitCodeSale=t),placeholder:"请输入销售单位"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"单位重量",prop:"unitWeight"},{default:a(()=>[e(r,{modelValue:l(d).unitWeight,"onUpdate:modelValue":o[29]||(o[29]=t=>l(d).unitWeight=t),placeholder:"请输入单位重量"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"安全库存",prop:"safetyStock"},{default:a(()=>[e(r,{modelValue:l(d).safetyStock,"onUpdate:modelValue":o[30]||(o[30]=t=>l(d).safetyStock=t),placeholder:"请输入安全库存"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"使用部位",prop:"partsUsed"},{default:a(()=>[e(r,{modelValue:l(d).partsUsed,"onUpdate:modelValue":o[31]||(o[31]=t=>l(d).partsUsed=t),placeholder:"请输入使用部位"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:"季节",prop:"season"},{default:a(()=>[e(r,{modelValue:l(d).season,"onUpdate:modelValue":o[32]||(o[32]=t=>l(d).season=t),placeholder:"请输入季节"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(u,{label:f.$t("brandInfo.remark"),prop:"remark"},{default:a(()=>[e(r,{modelValue:l(d).remark,"onUpdate:modelValue":o[33]||(o[33]=t=>l(d).remark=t),type:"textarea",clearable:"",placeholder:`${f.$t("input")}${f.$t("brandInfo.remark")} `},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Ue as default};
