import{b as B,e as x,r as m,W as ee,f as ae,h as g,o as E,c as te,L as le,M as oe,k as e,i as t,j as o,p as ne,x as N,t as V,$ as M,I as K,n as se,s as re,v as ue,z as de}from"./index-BP30Yz_m.js";import{C as ie}from"./index-DTWQQqpJ.js";import{l as pe,u as ce,a as me,g as fe,d as ge}from"./storeGroup-Bzh_WGUj.js";import{r as L}from"./verify-D2E6NcQX.js";function be(){const{t:l}=B();return{pageData:x({columnData:[{label:l("storeGroup.groupCode"),prop:"groupCode",width:"auto",fixed:"left"},{label:l("storeGroup.groupName"),prop:"groupName",width:"auto",fixed:"left"},{label:l("remark"),prop:"remark",width:"auto"},{label:l("is_disable"),prop:"disable",width:"auto"},{label:l("operate"),prop:"operate",width:"auto",fixed:"right"}]})}}function _e(){const l=x({pageSize:10,pageNum:1,groupName:null,disable:0}),a=x({list:[],total:0}),i=m(),_=()=>{l.pageNum=1,l.pageSize=10,l.disable=0},s=()=>{i.value&&(i.value.resetFields(),i.value.clearValidate());for(const r in l)Object.prototype.hasOwnProperty.call(l,r)&&(l[r]=void 0);_(),c()},c=async()=>{const{rows:r,total:C}=await pe(l);a.list=r,a.total=C};return{formData:l,loadData:c,searchFormRef:i,resetData:s,tableData:a,reloadData:_}}function he(){const{t:l}=B(),a=x({groupCode:null,groupName:null,remark:null}),i=m(),_=x({groupCode:L(l("storeGroup.groupCode")+l("cannot_empty")),groupName:L(l("storeGroup.groupName")+l("cannot_empty"))}),s=m(""),c=m(!1),r=m([]),C=async()=>new Promise(async(p,b)=>{if(!i.value){b(!1);return}try{await i.value.validate(),a.id?await ce(a):(r.value.push(a),await me(a)),$(),ee({type:"success",message:l("operate_success")}),p(!0)}catch(h){throw b(h),h}}),f=m(!1),d=m(!1),F=async(p,b)=>{if(s.value=d.value?l("check_details"):p&&b?l("edit")+l("storeGroup.storeGroup"):l("add")+l("storeGroup.storeGroup"),c.value=!!(p&&b),R(),f.value=!0,b){const{data:h}=await fe({id:b});for(let D in h)Object.prototype.hasOwnProperty.call(h,D)&&(a[D]=h[D])}},R=()=>{i.value&&(i.value.resetFields(),i.value.clearValidate());for(let p in a)a[p]=void 0},$=()=>{f.value=!1,d.value=!1,R(),r.value=[]};return{updateFormData:a,updateFormRef:i,updateFormRules:_,submit:C,showHandle:f,openHandle:F,closeHandle:$,title:s,disabled:c,handleCheckDetail:p=>{d.value=!0,F(p,p.id)},colorList:r,isDetails:d}}const w=m([]),T=m();function ye(l,a){async function i(s){s.id||T.value;const c=w.value.length>0&&w.value.every(d=>d.disable),r=!w.value.length&&s.disable,C=async()=>{await ge({id:s.id}),T.value="",w.value=[],a.$modal.msgSuccess(l("operate_success"))},f=d=>a.$modal.confirm(d).then(C);c?await f(l("delete_tip1")):w.value.length?await f(l("delete_tip2")):r?await f(l("delete_tip4")):await f(l("delete_tip3"))}function _({rowList:s}){w.value=s;const c=s.map(r=>r.id);T.value=c.join(",")}return{deleteHandler:i,select:_,idList:w}}const ke={class:"app-container"},Ce={class:"dialog-footer"},Ve=Object.assign({name:"StoreGroup"},{__name:"index",setup(l){const{t:a}=B(),{proxy:i}=de(),{pageData:_}=be(),{formData:s,tableData:c,loadData:r,searchFormRef:C,resetData:f}=_e(),{updateFormData:d,updateFormRef:F,updateFormRules:R,submit:$,openHandle:z,showHandle:p,title:b,handleCheckDetail:h,closeHandle:D,isDetails:G}=he(),{deleteHandler:q,select:Q,idList:ve}=ye(a,i),H=m(!0),W=m("");ae(()=>{r()});const A=async()=>{try{await $(),setTimeout(()=>{r()},50)}catch(y){throw y}},J=async y=>{await q(y),setTimeout(()=>{r()},50)};return(y,u)=>{const U=g("el-input"),S=g("el-form-item"),v=g("el-col"),X=g("el-checkbox"),k=g("el-button"),I=g("el-row"),P=g("el-form"),O=g("el-tooltip"),Y=g("el-tag"),Z=g("el-dialog");return E(),te("div",ke,[le(t(P,{model:e(s),ref_key:"searchFormRef",ref:C,inline:!0,labelSuffix:":"},{default:o(()=>[t(I,{gutter:20},{default:o(()=>[t(v,{lg:4,sm:12,md:12,xs:24},{default:o(()=>[t(S,{label:e(a)("storeGroup.groupName"),prop:"groupName"},{default:o(()=>[t(U,{modelValue:e(s).groupName,"onUpdate:modelValue":u[0]||(u[0]=n=>e(s).groupName=n),placeholder:e(a)("input")+e(a)("storeGroup.groupName"),clearable:"",onKeyup:ne(e(r),["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1},8,["label"])]),_:1}),t(v,{lg:2,sm:12,md:12,xs:24},{default:o(()=>[t(S,{label:"",prop:"delFlag"},{default:o(()=>[t(X,{modelValue:e(s).disable,"onUpdate:modelValue":u[1]||(u[1]=n=>e(s).disable=n),onChange:e(r),"true-label":1,"false-label":0,label:e(a)("include_disable"),size:"large"},null,8,["modelValue","onChange","label"])]),_:1})]),_:1}),t(v,{lg:4,sm:12,md:12,xs:24},{default:o(()=>[t(S,null,{default:o(()=>[t(k,{type:"primary",icon:"Search",onClick:e(r)},{default:o(()=>[N(V(e(a)("query")),1)]),_:1},8,["onClick"]),t(k,{icon:"Refresh",onClick:e(f)},{default:o(()=>[N(V(e(a)("reset")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),[[oe,e(H)]]),t(I,{gutter:10,class:"mb10 mt10"},{default:o(()=>[t(v,{span:1.5},{default:o(()=>[t(k,{type:"primary",plain:"",icon:"Plus",onClick:e(z)},{default:o(()=>[N(V(e(a)("add")),1)]),_:1},8,["onClick"])]),_:1})]),_:1}),t(ie,{loading:e(M)().loading,onSelect:e(Q),ref_key:"tableRef",ref:W,onQueryTable:e(r),showSearch:e(H),"onUpdate:showSearch":u[2]||(u[2]=n=>K(H)?H.value=n:null),"table-key":"storeGroupId",onHandleCurrentChange:e(r),total:e(c).total,showMultipleColumn:"",pageSize:e(s).pageSize,"onUpdate:pageSize":u[3]||(u[3]=n=>e(s).pageSize=n),pageNum:e(s).pageNum,"onUpdate:pageNum":u[4]||(u[4]=n=>e(s).pageNum=n),operateWidth:"100px",tableData:e(c).list,columnData:e(_).columnData,showSummary:!1,showOperate:!1,"show-multiple":!1,"show-multiple-column":!0,showPagination:!0},{operateDefault:o(({data:{row:n}})=>[t(O,{class:"box-item",effect:"dark",content:y.$t("check_details"),placement:"top-start"},{default:o(()=>[t(k,{link:"",type:"primary",icon:"View",onClick:j=>e(h)(n)},null,8,["onClick"])]),_:2},1032,["content"]),t(O,{class:"box-item",effect:"dark",content:y.$t("edit"),placement:"top-start"},{default:o(()=>[t(k,{link:"",type:"primary",icon:"Edit",disabled:n.notEdit,onClick:j=>e(z)(n,n.id)},null,8,["disabled","onClick"])]),_:2},1032,["content"]),t(O,{class:"box-item",effect:"dark",content:y.$t("delete"),placement:"top-start"},{default:o(()=>[t(k,{link:"",type:"primary",icon:"Delete",disabled:n.notDelete,onClick:j=>J(n)},null,8,["disabled","onClick"])]),_:2},1032,["content"])]),disableDefault:o(({data:{row:n}})=>[t(Y,{type:n.disable?"info":"success"},{default:o(()=>[N(V(n.disable?e(a)("disabled"):e(a)("normal")),1)]),_:2},1032,["type"])]),_:1},8,["loading","onSelect","onQueryTable","showSearch","onHandleCurrentChange","total","pageSize","pageNum","tableData","columnData"]),t(Z,{title:e(b),modelValue:e(p),"onUpdate:modelValue":u[8]||(u[8]=n=>K(p)?p.value=n:null),width:"500px","append-to-body":"",onClose:e(D)},{footer:o(()=>[se("div",Ce,[e(G)?ue("",!0):(E(),re(k,{key:0,type:"primary",class:"btn-confirm",loading:e(M)().loading,onClick:A},{default:o(()=>[N(V(e(a)("confirm")),1)]),_:1},8,["loading"])),t(k,{class:"btn-cancel",onClick:e(D)},{default:o(()=>[N(V(e(G)?e(a)("close"):e(a)("cancel")),1)]),_:1},8,["onClick"])])]),default:o(()=>[t(P,{ref_key:"updateFormRef",ref:F,"label-position":"left",model:e(d),rules:e(R),"label-suffix":"ï¼š"},{default:o(()=>[t(I,{gutter:20},{default:o(()=>[t(v,{span:24},{default:o(()=>[t(S,{label:e(a)("storeGroup.groupCode"),prop:"groupCode"},{default:o(()=>[t(U,{modelValue:e(d).groupCode,"onUpdate:modelValue":u[5]||(u[5]=n=>e(d).groupCode=n),disabled:e(G),placeholder:e(a)("input")+e(a)("storeGroup.groupCode")},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])]),_:1}),t(v,{span:24},{default:o(()=>[t(S,{label:e(a)("storeGroup.groupName"),prop:"groupName"},{default:o(()=>[t(U,{modelValue:e(d).groupName,"onUpdate:modelValue":u[6]||(u[6]=n=>e(d).groupName=n),disabled:e(G),placeholder:e(a)("input")+e(a)("storeGroup.groupName")},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])]),_:1}),t(v,{span:24},{default:o(()=>[t(S,{label:y.$t("remark"),prop:"remark"},{default:o(()=>[t(U,{modelValue:e(d).remark,"onUpdate:modelValue":u[7]||(u[7]=n=>e(d).remark=n),type:"textarea",clearable:"",disabled:e(G),placeholder:`${e(a)("input")}${e(a)("remark")} `},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onClose"])])}}});export{Ve as default};
