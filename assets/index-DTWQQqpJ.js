import{h as c,o as p,c as C,q as Y,s as H,j as i,X as w,x as b,t as $,F as J,Y as G,v as V,_ as ne,a4 as we,k as l,L as y,n as _,i as d,a5 as te,M as k,a6 as ae,a7 as le,a8 as be,b as ve,D as O,r as N,w as Se,K as De,W as oe,J as Ne}from"./index-BP30Yz_m.js";const He=Object.assign({inheritAttrs:!0,customOptions:{name:"HeaderTable"}},{__name:"index",props:{isChildren:{type:Boolean,default:!1},columnData:{type:Array,default:()=>[]}},setup(o){return(a,f)=>{const h=c("el-table-column");return p(!0),C(J,null,Y(o.columnData,(t,s)=>(p(),H(h,G(t,{key:s,align:"center",resizable:""}),{header:i(()=>[w(a.$slots,"propHeader",{data:t},()=>[b($(t.label),1)])]),default:i(({row:v,column:M,$index:E})=>{var B;return[w(a.$slots,"propDefault",{data:{row:v,column:M,$index:E,prop:t.prop}},()=>[b($(v[t.prop]),1)]),t.children&&((B=t.children)!=null&&B.length)?(p(!0),C(J,{key:0},Y(t.children,(u,g)=>(p(),H(h,G(u,{key:g}),{header:i(()=>[w(a.$slots,"propHeader",{data:u},()=>[b($(u.label),1)])]),default:i(({row:z,column:P,$index:Q})=>[w(a.$slots,"propDefault",{data:{row:z,column:P,$index:Q,prop:u.prop,value:z[u.prop]}},()=>[b($(z[u.prop]),1)])]),_:2},1040))),128)):V("",!0)]}),_:2},1040))),128)}}}),$e={key:0,class:"operate"},Le=["onClick"],xe={class:"edit"},Ve={class:"del"},Be={key:1,class:"operate"},Te=["onClick"],Ae=["onClick"],Me={key:2,class:"operate"},Ee={__name:"index",setup(o){const a=we();return console.log("attrs",a),console.log(a.operateList,77),(f,h)=>{const t=c("el-button"),s=c("el-icon"),v=c("el-dropdown-item"),M=c("el-dropdown-menu"),E=c("el-dropdown"),B=c("el-table-column");return p(),H(B,{label:"操作",width:l(a).operateWidth||"auto",align:"center"},{default:i(({$index:u})=>[l(a).operateType===0?(p(),C("div",$e,[y(_("div",{class:"add",onClick:g=>l(a).onAddHandClick(u)},[d(t,{disabled:l(a).loading||!1,type:"info",icon:l(te),circle:""},null,8,["disabled","icon"])],8,Le),[[k,l(a).operateList.includes("add")]]),y(_("div",xe,[d(t,{type:"primary",onClick:g=>l(a).onEditHandClick(u),icon:l(ae),circle:"",disabled:l(a).loading||!1},null,8,["onClick","icon","disabled"])],512),[[k,l(a).operateList.includes("edit")]]),y(_("div",Ve,[d(t,{onClick:g=>l(a).onDelHandClick(u),type:"danger",circle:"",icon:l(le),disabled:l(a).loading||!1},null,8,["onClick","icon","disabled"])],512),[[k,l(a).operateList.includes("del")]]),w(f.$slots,"more",{data:u},void 0,!0)])):l(a).operateType===1?(p(),C("div",Be,[y(_("div",{class:"add",onClick:h[0]||(h[0]=g=>l(a).onAddHandClick())},[d(s,null,{default:i(()=>[d(l(te))]),_:1})],512),[[k,l(a).operateList.includes("add")]]),y(_("div",{class:"edit",onClick:g=>l(a).onEditHandClick(u)},[d(s,null,{default:i(()=>[d(l(ae))]),_:1})],8,Te),[[k,l(a).operateList.includes("edit")]]),y(_("div",{class:"del",onClick:g=>l(a).onDelHandClick(u)},[d(s,null,{default:i(()=>[d(l(le))]),_:1})],8,Ae),[[k,l(a).operateList.includes("del")]]),w(f.$slots,"more",{data:u},void 0,!0)])):l(a).operateType===2?(p(),C("div",Me,[d(E,null,{dropdown:i(()=>[d(M,null,{default:i(()=>[y(d(v,{onClick:h[1]||(h[1]=g=>l(a).onAddHandClick())},{default:i(()=>[b("新增")]),_:1},512),[[k,l(a).operateList.includes("add")]]),y(d(v,{onClick:g=>l(a).onEditHandClick(u)},{default:i(()=>[b("编辑")]),_:2},1032,["onClick"]),[[k,l(a).operateList.includes("edit")]]),y(d(v,{onClick:g=>l(a).onDelHandClick(u)},{default:i(()=>[b("删除 ")]),_:2},1032,["onClick"]),[[k,l(a).operateList.includes("del")]]),w(f.$slots,"more",{data:u},void 0,!0)]),_:2},1024)]),default:i(()=>[d(s,null,{default:i(()=>[d(l(be))]),_:1})]),_:2},1024)])):V("",!0)]),_:3},8,["width"])}}},ze=ne(Ee,[["__scopeId","data-v-9ee77c00"]]);function de(o){if(!o&&typeof o!="object")throw new Error("error arguments","deepClone");const a=o.constructor===Array?[]:{};return Object.keys(o).forEach(f=>{o[f]&&typeof o[f]=="object"?a[f]=de(o[f]):a[f]=o[f]}),a}const Xe=[new Date(2e3,1,1,0,0,0),new Date(2e3,2,1,23,59,59)],Re={class:"search"},Ie={key:0,class:"chose-column"},Oe={class:"check"},Ke={key:1},Ue={key:0},We={key:1},qe={class:"pagination"},Fe={class:"popover",id:"popover"},Je={__name:"index",props:{columnData:{type:Array,default:()=>[]},tableData:{type:Array,default:[]},tableConfig:{type:Array,default:[]},showOperate:{type:Boolean,default:!1},operateType:{type:Number,default:0},operateList:{type:Array,default:["edit","del"]},operateWidth:{type:String,default:"auto"},showMultiple:{type:Boolean,default:!0},showIndex:{type:Boolean,default:!0},maxMultipleNum:{default:void 0},loading:{type:Boolean,default:!1},showSummary:{type:Boolean,default:!1},hideSummaryList:{type:Array,default:()=>[]},summaryList:{type:Array,default:()=>[]},pageNum:{type:Number,default:1},pageSize:{type:Number,default:20},total:100,showPagination:{type:Boolean,default:!0},showMultipleColumn:{type:Boolean,default:!0},rowClassRowConditions:{type:Function,default:o=>!1},rowClassName:{type:String,default:""},showSearch:{type:Boolean,default:!1},tableKey:{type:String,default:""},showEdit:{type:Boolean,default:!1},maxHeight:{type:[String,Number],default:"auto"},isShowTool:{type:Boolean,default:!0},rowKey:{type:String,default:""}},emits:["editHandClick","delHandClick","addHandClick","handleSelectionChange","getSummaries","sortChange","select","update:pageNum","update:pageSize","update:showSearch","handleRowClick","queryTable","handleCurrentChange","tableCurrentChange","hanldeCellClick"],setup(o,{expose:a,emit:f}){const{t:h}=ve(),t=o,s=f;function v(e){console.log("del"),s("delHandClick",e)}function M(e){console.log("edit"),s("editHandClick",e)}function E(e){console.log("add"),s("addHandClick",e)}function B(e){if(t.maxMultipleNum&&e.length>t.maxMultipleNum){console.log("selection",e);let m=e.shift();K.value.toggleRowSelection(m,!1),oe({type:"warning",message:`最多支持选择${t.maxMultipleNum}个！`})}let r=e.map(m=>m.id);r=r.filter(m=>m!=null),s("select",{rowList:e,idList:r})}function u(e){t.maxMultipleNum&&e.length>t.maxMultipleNum&&(oe({type:"warning",message:`最多支持选择${t.maxMultipleNum}个！`}),e.length=t.maxMultipleNum);let r=e.map(m=>m.id);r=r.filter(m=>m!=null),s("select",{rowList:e,idList:r})}const g=e=>{var W;const{columns:r,data:m}=e,L=[];let x=[];return(W=t.hideSummaryList)!=null&&W.length?r.forEach(T=>{t.hideSummaryList.includes(T.property)?x.push({}):x.push(T)}):x=de(r),x.forEach((T,A)=>{if(A===0){L[A]="本页合计";return}const R=m.map(D=>Number(D[T.property]));if(R.every(D=>Number.isNaN(D)))L[A]="";else{let D=R.reduce((q,F)=>{const X=Number(F);return Number.isNaN(X)?q:q+F},0);L[A]=`${Math.round(D*100)/100}`}}),L};function z({column:e,prop:r,order:m}){s("sortChange",{column:e,prop:r,order:m})}function P(e){s("update:pageNum",e),s("handleCurrentChange",e)}function Q(e){s("update:pageSize",e),s("handleCurrentChange",t.pageNum)}const re=O(()=>{let e=[];return t.total<=10?e=[1,5,10]:t.total<=20?e=[5,10,20]:t.total<=50?e=[10,20,30,40,50]:t.total<=100?e=[5,10,20,50,100]:e=[10,50,100,150,200],e}),ie=O(()=>S.value.length>0&&S.value.length<t.columnData.length),S=N(JSON.parse(localStorage.getItem(t.tableKey)||"null")||t.columnData.map(e=>e.prop)),Z=O({get:()=>S.value.length===t.columnData.length,set:e=>{S.value=e?t.columnData.map(r=>r.prop):[]}});Se(S,e=>{localStorage.setItem(t.tableKey,JSON.stringify(e))});const se=O(()=>t.columnData.filter(e=>S.value.includes(e.prop))),K=N(),ue=e=>{s("handleRowClick",{...e});let r=document.querySelector("#popover");r.style.display="none"};a({tableRef:K,clearSelection:()=>K.value.clearSelection()});function ce(e){s("tableCurrentChange",e)}function pe({row:e}){if(t.rowClassRowConditions(e))return t.rowClassName}function me(){s("queryTable")}function fe(){s("update:showSearch",!t.showSearch)}const he=O(()=>e=>t.tableData[e].isEdit&&t.showEdit),j=N(""),ee=N(),ge=(e,r,m,L)=>{e.isEdit=!0,j.value=r.property,Ne(()=>{ee.value.focus()})},ye=e=>{e.isEdit=!1,s("hanldeCellClick",e,t.tableData)},U=N();N();const Ce=e=>e[t.rowKey];return N(t.columnData),N(t.tableData),(e,r)=>{const m=c("el-button"),L=c("el-tooltip"),x=c("el-checkbox"),W=c("el-checkbox-group"),T=c("el-popover"),A=c("right-toolbar"),R=c("el-table-column"),D=c("el-input"),q=c("el-table"),F=c("el-pagination"),X=c("el-color-picker"),_e=c("el-card"),ke=De("loading");return p(),C(J,null,[_("div",Re,[o.showMultipleColumn?(p(),C("div",Ie,[d(T,{placement:"bottom",trigger:"click",width:"10%"},{reference:i(()=>[_("div",null,[d(L,{class:"box-item",effect:"dark",content:l(h)("display_hide_columns"),placement:"top"},{default:i(()=>[d(m,{circle:"",icon:"Menu"})]),_:1},8,["content"])])]),default:i(()=>[_("div",Oe,[d(x,{modelValue:Z.value,"onUpdate:modelValue":r[0]||(r[0]=n=>Z.value=n),indeterminate:ie.value},{default:i(()=>[b($(l(h)("check_all")),1)]),_:1},8,["modelValue","indeterminate"]),d(W,{modelValue:S.value,"onUpdate:modelValue":r[1]||(r[1]=n=>S.value=n)},{default:i(()=>[(p(!0),C(J,null,Y(o.columnData,n=>(p(),H(x,{class:"checkbox",key:n.prop,label:n.prop,value:n.prop},{default:i(()=>[b($(n.label),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1})])):V("",!0),o.isShowTool?(p(),C("div",Ke,[d(A,{onToggleSearch:fe,"show-search":o.showSearch,onQueryTable:me},null,8,["show-search"])])):V("",!0)]),y((p(),H(q,G({"row-class-name":pe,onCurrentChange:ce,"max-height":o.maxHeight,"header-cell-stdelHandClickyle":{background:"#f0f2f5"},showSummary:o.showSummary,"row-key":Ce,"show-overflow-tooltip":!0,onCellDblclick:ge,"scrollbar-always-on":"","sum-text":"合计",border:!0},{...o.tableConfig},{data:o.tableData,stripe:"",style:{width:"100%"},onSelect:B,onSelectAll:u,"summary-method":g,onRowClick:ue,ref_key:"tableRef",ref:K,onSortChange:z}),{default:i(()=>[o.showMultiple?(p(),H(R,{key:0,type:"selection",width:"55"})):V("",!0),o.showIndex?(p(),H(R,{key:1,type:"index",label:l(h)("serial_number"),width:"115",align:"center",fixed:o.showIndex},null,8,["label","fixed"])):V("",!0),d(He,{columnData:se.value},{propHeader:i(n=>{var I;return[w(e.$slots,`${(I=n.data)==null?void 0:I.prop}Header`,{data:n.data},()=>[b($(n.data.label),1)],!0)]}),propDefault:i(n=>[w(e.$slots,`${n.data.prop}Default`,{data:n.data},()=>[he.value(n.data.$index)&&n.data.prop===j.value?(p(),C("span",Ue,[d(D,{modelValue:n.data.row[n.data.prop],"onUpdate:modelValue":I=>n.data.row[n.data.prop]=I,ref_key:"inputRef",ref:ee,onBlur:I=>ye(n.data.row)},null,8,["modelValue","onUpdate:modelValue","onBlur"])])):(p(),C("span",We,$(n.data.row[n.data.prop]),1))],!0)]),_:3},8,["columnData"]),o.showOperate?(p(),H(ze,{key:2,loading:o.loading,operateWidth:o.operateWidth,onAddHandClick:E,onDelHandClick:v,onEditHandClick:M,operateType:o.operateType,operateList:o.operateList,fixed:"right"},{more:i(({data:n})=>[w(e.$slots,"moreOperate",{data:{$index:n}},void 0,!0)]),_:3},8,["loading","operateWidth","operateType","operateList"])):V("",!0)]),_:3},16,["max-height","showSummary","data"])),[[ke,o.loading]]),y(_("div",qe,[d(F,{"current-page":o.pageNum,"page-size":o.pageSize,"page-sizes":re.value,"hide-on-single-page":!1,small:!1,disabled:o.loading,layout:"total, sizes, prev, pager, next, jumper",total:o.total,onSizeChange:Q,onCurrentChange:P},null,8,["current-page","page-size","page-sizes","disabled","total"])],512),[[k,o.showPagination]]),_("div",Fe,[d(_e,{style:{"max-width":"580px"}},{default:i(()=>[d(D,{modelValue:U.value,"onUpdate:modelValue":r[3]||(r[3]=n=>U.value=n),placeholder:l(h)("set")+l(h)("colorLibrary.16Color")},{append:i(()=>[d(X,{size:"small",modelValue:U.value,"onUpdate:modelValue":r[2]||(r[2]=n=>U.value=n)},null,8,["modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1})])],64)}}},Ye=ne(Je,[["__scopeId","data-v-450af4bb"]]);export{Ye as C,Xe as d};
