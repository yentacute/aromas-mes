import{b as z,e as N,V as U,r as _,W as le,f as te,h as b,o as ae,c as oe,L as ne,M as re,k as l,i as e,j as t,p as K,x as D,t as V,$ as P,I as j,n as se,z as de}from"./index-BP30Yz_m.js";import{C as ue}from"./index-DTWQQqpJ.js";import{r as M}from"./verify-D2E6NcQX.js";function ie(){const{t:o}=z();return{pageData:N({columnData:[{label:"颜色编码",prop:"colorCode",width:"auto",fixed:"left"},{label:"颜色名称",prop:"colorName",width:"auto",fixed:"left"},{label:"十六进制颜色",prop:"sixteenDigitColor",width:"auto"},{label:"备注",prop:"remark",width:"auto"},{label:o("operate"),prop:"operate",width:"auto",fixed:"right"}]})}}function pe(o){return U({url:"/bok/styleColor/list",method:"get",params:o})}function ce(o){return U({url:"/bok/styleColor",method:"post",data:o})}function me(o){return U({url:"/bok/styleColor",method:"put",data:o})}function fe(o){return U({url:"/bok/styleColor/"+o,method:"delete"})}function be(){const o=N({pageSize:10,pageNum:1,colorCode:null,colorName:null,disable:0}),d=N({list:[],total:0}),u=_(),h=()=>{o.pageNum=1,o.pageSize=10,o.disable=0},n=()=>{u.value&&(u.value.resetFields(),u.value.clearValidate());for(const s in o)Object.prototype.hasOwnProperty.call(o,s)&&(o[s]=void 0);h(),c()},c=async()=>{const{rows:s,total:g}=await pe(o);d.list=s,d.total=g};return{formData:o,loadData:c,searchFormRef:u,resetData:n,tableData:d,reloadData:h}}function ge(){const{t:o}=z(),d=N({colorCode:null,colorName:null,sixteenDigitColor:null,remark:null,modifyId:null,modifyName:null,modifyTime:null,notDelete:null,notEdit:null,disable:null,companyId:null}),u=_(),h=N({colorCode:M("颜色编码不能为空"),colorName:M("颜色名称不能为空")}),n=_(""),c=_(!1),s=async()=>new Promise(async(m,v)=>{if(!u.value){v(!1);return}try{await u.value.validate(),d.id?await me(d):await ce(d),$(),le({type:"success",message:o("operate_success")}),m(!0)}catch(y){throw v(y),y}}),g=_(!1),k=(m,v)=>{if(n.value=m&&v?"修改成品色号":"新增成品色号",c.value=!!(m&&v),i(),g.value=!0,v)for(let y in m)Object.prototype.hasOwnProperty.call(m,y)&&(d[y]=m[y]);d.disable=0},i=()=>{u.value&&(u.value.resetFields(),u.value.clearValidate());for(let m in d)d[m]=void 0;d.disable=0},$=()=>{g.value=!1,i()};return{updateFormData:d,updateFormRef:u,updateFormRules:h,submit:s,showHandle:g,openHandle:k,closeHandle:$,title:n,disabled:c}}const S=_([]),I=_();function ye(o,d){async function u(n){n.id||I.value;const c=S.value.length>0&&S.value.every(i=>i.disable),s=!S.value.length&&n.disable,g=async()=>{await fe(n.id),I.value="",S.value=[],d.$modal.msgSuccess(o("operate_success"))},k=i=>d.$modal.confirm(i).then(g);c?await k(o("delete_tip1")):S.value.length?await k(o("delete_tip2")):s?await k(o("delete_tip4")):await k(o("delete_tip3"))}function h({rowList:n}){S.value=n;const c=n.map(s=>s.id);I.value=c.join(",")}return{deleteHandler:u,select:h,idList:S}}const Ce={class:"app-container"},_e={class:"dialog-footer"},De=Object.assign({name:"FabricColor"},{__name:"index",setup(o){const{t:d}=z(),{proxy:u}=de(),{pageData:h}=ie(),{formData:n,tableData:c,loadData:s,searchFormRef:g,resetData:k}=be(),{updateFormData:i,updateFormRef:$,updateFormRules:m,submit:v,openHandle:y,showHandle:F,title:q,closeHandle:L,disabled:he}=ge(),{deleteHandler:Q,select:W,idList:T}=ye(d,u),R=_(!0),A=_("");te(()=>{s()});const G=async()=>{try{await v(),setTimeout(()=>{s()},50)}catch(p){throw p}},B=async p=>{await Q(p),setTimeout(()=>{s()},50)};function J(){u.download("bok/fabricColor/export",{...n},`fabricColor${new Date().getTime()}.xlsx`)}return(p,r)=>{const x=b("el-input"),w=b("el-form-item"),f=b("el-col"),X=b("el-checkbox"),C=b("el-button"),H=b("el-row"),O=b("el-form"),E=b("el-tooltip"),Y=b("el-tag"),Z=b("el-dialog");return ae(),oe("div",Ce,[ne(e(O,{model:l(n),ref_key:"searchFormRef",ref:g,inline:!0,labelSuffix:":"},{default:t(()=>[e(H,{gutter:20},{default:t(()=>[e(f,{lg:4,sm:12,md:12,xs:24},{default:t(()=>[e(w,{label:"颜色编码",prop:"colorCode"},{default:t(()=>[e(x,{modelValue:l(n).colorCode,"onUpdate:modelValue":r[0]||(r[0]=a=>l(n).colorCode=a),placeholder:"请输入颜色编码",clearable:"",onKeyup:K(l(s),["enter"])},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(f,{lg:4,sm:12,md:12,xs:24},{default:t(()=>[e(w,{label:"颜色名称",prop:"colorName"},{default:t(()=>[e(x,{modelValue:l(n).colorName,"onUpdate:modelValue":r[1]||(r[1]=a=>l(n).colorName=a),placeholder:"请输入颜色名称",clearable:"",onKeyup:K(l(s),["enter"])},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(f,{lg:2,sm:12,md:12,xs:24},{default:t(()=>[e(w,{label:"",prop:"delFlag"},{default:t(()=>[e(X,{modelValue:l(n).disable,"onUpdate:modelValue":r[2]||(r[2]=a=>l(n).disable=a),onChange:l(s),"true-label":1,"false-label":0,label:"包含禁用",size:"large"},null,8,["modelValue","onChange"])]),_:1})]),_:1}),e(f,{lg:4,sm:12,md:12,xs:24},{default:t(()=>[e(w,null,{default:t(()=>[e(C,{type:"primary",icon:"Search",onClick:l(s)},{default:t(()=>[D(V(p.$t("query")),1)]),_:1},8,["onClick"]),e(C,{icon:"Refresh",onClick:l(k)},{default:t(()=>[D(V(p.$t("reset")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),[[re,l(R)]]),e(H,{gutter:10,class:"mb10 mt10"},{default:t(()=>[e(f,{span:1.5},{default:t(()=>[e(C,{type:"primary",plain:"",icon:"Plus",onClick:l(y)},{default:t(()=>[D(V(p.$t("add")),1)]),_:1},8,["onClick"])]),_:1}),e(f,{span:1.5},{default:t(()=>[e(C,{type:"danger",plain:"",icon:"Delete",disabled:!l(T).length,onClick:B},{default:t(()=>[D(V(p.$t("delete")),1)]),_:1},8,["disabled"])]),_:1}),e(f,{span:1.5},{default:t(()=>[e(C,{type:"warning",plain:"",icon:"Download",onClick:J,class:"btn-export"},{default:t(()=>[D("导出")]),_:1})]),_:1})]),_:1}),e(ue,{loading:l(P)().loading,onSelect:l(W),ref_key:"tableRef",ref:A,onQueryTable:l(s),showSearch:l(R),"onUpdate:showSearch":r[3]||(r[3]=a=>j(R)?R.value=a:null),"table-key":"fabricColorId",onHandleCurrentChange:l(s),total:l(c).total,showMultipleColumn:"",pageSize:l(n).pageSize,"onUpdate:pageSize":r[4]||(r[4]=a=>l(n).pageSize=a),pageNum:l(n).pageNum,"onUpdate:pageNum":r[5]||(r[5]=a=>l(n).pageNum=a),operateWidth:"100px",tableData:l(c).list,columnData:l(h).columnData,showSummary:!1,showOperate:!1,"show-multiple":!0,"show-multiple-column":!0,showPagination:!0},{operateDefault:t(({data:{row:a}})=>[e(E,{class:"box-item",effect:"dark",content:p.$t("edit"),placement:"top-start"},{default:t(()=>[e(C,{link:"",type:"primary",icon:"Edit",onClick:ee=>l(y)(a,a.id)},null,8,["onClick"])]),_:2},1032,["content"]),e(E,{class:"box-item",effect:"dark",content:p.$t("edit"),placement:"top-start"},{default:t(()=>[e(C,{link:"",type:"primary",icon:"Delete",disabled:!!l(T).length,onClick:ee=>B(a)},null,8,["disabled","onClick"])]),_:2},1032,["content"])]),delFlagDefault:t(({data:{row:a}})=>[e(Y,{type:a.delFlag?"info":"success"},{default:t(()=>[D(V(a.delFlag?"禁用":"正常"),1)]),_:2},1032,["type"])]),_:1},8,["loading","onSelect","onQueryTable","showSearch","onHandleCurrentChange","total","pageSize","pageNum","tableData","columnData"]),e(Z,{title:l(q),modelValue:l(F),"onUpdate:modelValue":r[11]||(r[11]=a=>j(F)?F.value=a:null),width:"500px","append-to-body":"",onClose:l(L)},{footer:t(()=>[se("div",_e,[e(C,{type:"primary",class:"btn-confirm",loading:l(P)().loading,onClick:G},{default:t(()=>[D(V(p.$t("confirm")),1)]),_:1},8,["loading"]),e(C,{class:"btn-cancel",onClick:r[10]||(r[10]=a=>F.value=!1)},{default:t(()=>[D(V(p.$t("cancel")),1)]),_:1})])]),default:t(()=>[e(O,{ref_key:"updateFormRef",ref:$,"label-position":"left",model:l(i),rules:l(m),"label-suffix":"："},{default:t(()=>[e(H,{gutter:20},{default:t(()=>[e(f,{span:24},{default:t(()=>[e(w,{label:"颜色编码",prop:"colorCode"},{default:t(()=>[e(x,{modelValue:l(i).colorCode,"onUpdate:modelValue":r[6]||(r[6]=a=>l(i).colorCode=a),placeholder:"请输入颜色编码"},null,8,["modelValue"])]),_:1})]),_:1}),e(f,{span:24},{default:t(()=>[e(w,{label:"颜色名称",prop:"colorName"},{default:t(()=>[e(x,{modelValue:l(i).colorName,"onUpdate:modelValue":r[7]||(r[7]=a=>l(i).colorName=a),placeholder:"请输入颜色名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(f,{span:24},{default:t(()=>[e(w,{label:"十六进制颜色",prop:"sixteenDigitColor"},{default:t(()=>[e(x,{modelValue:l(i).sixteenDigitColor,"onUpdate:modelValue":r[8]||(r[8]=a=>l(i).sixteenDigitColor=a),placeholder:"请输入十六进制颜色"},null,8,["modelValue"])]),_:1})]),_:1}),e(f,{span:24},{default:t(()=>[e(w,{label:p.$t("brandInfo.remark"),prop:"remark"},{default:t(()=>[e(x,{modelValue:l(i).remark,"onUpdate:modelValue":r[9]||(r[9]=a=>l(i).remark=a),type:"textarea",clearable:"",placeholder:`${p.$t("input")}${p.$t("brandInfo.remark")} `},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onClose"])])}}});export{De as default};
