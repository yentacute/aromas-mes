import{b as F,D as R,r as C,h as s,K as T,L as y,o as j,c as E,i as a,j as t,n,x as w,t as i,M as I,k as N,$ as P,W as p}from"./index-BP30Yz_m.js";const A={class:"el-upload__text"},M={class:"el-upload__tip"},q={class:"el-upload__tip"},K={class:"el-upload__tip"},W=n("div",{slot:"tip",class:"el-upload__tip",style:{display:"inline-block","margin-left":"20px"}},null,-1),z={class:"dialog-footer"},H=Object.assign({name:"CtnImportPopup"},{__name:"index",props:{uploadApi:{type:Function,required:!0},downloadParams:{type:Object,default:()=>({})},modelValue:{type:Boolean,default:!1},title:{type:String,default:""},cancelText:{type:String,default:""},confirmText:{type:String,default:""},width:{type:String,default:"50%"},action:{type:String,default:""},fileName:{type:String,default:void 0},showCancel:{type:Boolean,default:!0},showConfirm:{type:Boolean,default:!0},showLeftFooter:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},isDownloadRes:{type:Boolean,default:!1}},emits:["update:modelValue","confirmCallback","cancelCallback","download"],setup(d,{emit:k}){const{t:u}=F(),c=d,f=k,v=R(()=>c.modelValue),h=C();function x(){h.value.clearFiles(),l.value=[],f("update:modelValue",!1),f("cancelCallback")}const l=C([]),V=async()=>{if(console.log("this.fileList",l.value),l.value.length===0)return p({type:"warning",message:u("uploadInfo.info")});const e=l.value[0];console.log(e,"file");const o=e.name.toLowerCase().slice(e.name.lastIndexOf(".")+1);if(o!=="xlsx"&&o!=="xls"){p({type:"warning",message:u("uploadInfo.type")}),l.value=[];return}const r=new FormData;r.append("file",e.raw),await c.uploadApi(r).then(m=>{if(c.isDownloadRes){const g=window.URL.createObjectURL(new Blob([m],{type:"xlsx"}));console.log("blobUrl",g)}p({type:"success",message:u("uploadInfo.success")})}).finally(()=>{f("update:modelValue",!1),f("confirmCallback")})},B=e=>{if(e.name.indexOf("xlsx")==-1&&e.name.indexOf("xls")==-1){p({type:"warning",message:u("uploadInfo.type")}),l.value=[];return}else l.value.push(e.raw)},S=e=>p({type:"warning",message:u("uploadInfo.limit1")}),D=(e,o)=>{l.value=o};return(e,o)=>{const r=s("upload-filled"),m=s("el-icon"),g=s("el-upload"),L=s("el-col"),U=s("el-row"),b=s("el-button"),O=s("el-dialog"),$=T("loading");return y((j(),E("div",null,[a(O,{"destroy-on-close":"",onClose:x,modelValue:v.value,"onUpdate:modelValue":o[1]||(o[1]=_=>v.value=_),title:c.title,width:d.width,"align-center":"",draggable:"","close-on-click-modal":!1},{footer:t(()=>[n("div",null,[n("span",z,[y(a(b,{class:"btn-cancel",onClick:x},{default:t(()=>[w(i(c.cancelText),1)]),_:1},512),[[I,d.showCancel]]),y(a(b,{loading:N(P)().loading,type:"primary",onClick:V,class:"btn-confirm"},{default:t(()=>[w(i(c.confirmText),1)]),_:1},8,["loading"]),[[I,d.showConfirm]])])])]),default:t(()=>[a(U,{class:"pad-l-lg mg-t-lg"},{default:t(()=>[a(L,{span:24},{default:t(()=>[a(g,{ref_key:"upload",ref:h,"file-list":l.value,"onUpdate:fileList":o[0]||(o[0]=_=>l.value=_),accept:".xls,.xlsx",action:d.action,limit:"1",drag:"","auto-upload":!1,"on-exceed":S,"on-change":B,"on-remove":D},{tip:t(()=>[n("div",M," 1、"+i(e.$t("uploadInfo.tip1")),1),n("div",q," 2、"+i(e.$t("uploadInfo.tip2")),1),n("div",K," 3、"+i(e.$t("uploadInfo.tip3")),1)]),default:t(()=>[a(m,{class:"el-icon--upload"},{default:t(()=>[a(r)]),_:1}),n("div",A,[w(i(e.$t("uploadInfo.text1")),1),n("em",null," "+i(e.$t("uploadInfo.text2")),1)]),W]),_:1},8,["file-list","action"])]),_:1})]),_:1})]),_:1},8,["modelValue","title","width"])])),[[$,d.loading]])}}});export{H as _};
