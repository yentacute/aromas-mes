import{b as E,e as R,V as U,r as g,W as pe,f as me,h as f,o as G,c as P,L as fe,M as be,k as e,i as a,j as l,p as ge,x as p,t as m,$ as Z,I as ee,n as _e,s as q,v as ve,F as te,q as ae,z as ye}from"./index-BP30Yz_m.js";import{C as he}from"./index-DTWQQqpJ.js";import{r as Ce}from"./storeGroup-Bzh_WGUj.js";import{r as x}from"./verify-D2E6NcQX.js";/* empty css                                                              */function ke(){const{t:o}=E();return{pageData:R({columnData:[{label:o("storeArchives.materialCategory"),prop:"materialCategoryName",width:"150",fixed:"left"},{label:o("storeArchives.storeGroup"),prop:"groupName",width:"150",fixed:"left"},{label:o("storeArchives.storeCode"),prop:"storeCode",width:"150",fixed:"left"},{label:o("storeArchives.storeName"),prop:"storeName",width:"150"},{label:o("storeArchives.storeTypeCode"),prop:"storeTypeCode",width:"180"},{label:o("storeArchives.enableStorageLocation"),prop:"enableStorageLocation",width:"auto"},{label:o("storeArchives.allowNegativeStock"),prop:"isAllowNegativeStock",width:"auto"},{label:o("storeArchives.virtual"),prop:"isVirtual",width:"auto"},{label:o("is_disable"),prop:"disable",width:"auto"},{label:o("remark"),prop:"remark",width:"auto"},{label:o("operate"),prop:"operate",width:"150",fixed:"right"}]})}}function Se(o){return U({url:"/bok/store/getList",method:"get",params:o})}function Ve(o){return U({url:"/bok/store/getStoreById",method:"get",params:o})}function we(o){return U({url:"/bok/store/add",method:"post",data:o})}function Ae(o){return U({url:"/bok/store/updateStore",method:"post",data:o})}function Ne(o){return U({url:"/bok/store/delStore",method:"post",data:o})}function De(){return U({url:"/bok/materialCategory/getMaterialCategoryAll",method:"get"})}function xe(){const o=R({pageSize:10,pageNum:1,colorCode:null,colorName:null,disable:0}),t=R({list:[],total:0}),c=g(),V=g([]),n=g([]),_=()=>{o.pageNum=1,o.pageSize=10,o.disable=0},d=()=>{c.value&&(c.value.resetFields(),c.value.clearValidate());for(const u in o)Object.prototype.hasOwnProperty.call(o,u)&&(o[u]=void 0);_(),w()},w=async()=>{const{rows:u,total:A}=await Se(o);t.list=u,t.total=A};return{formData:o,loadData:w,searchFormRef:c,resetData:d,tableData:t,reloadData:_,storeGroupOptions:V,materialCategoryOptions:n,getOption:async()=>{const[u,A]=await Promise.all([Ce(),De()]);V.value=u.data,n.value=A.data}}}function Le(){const{t:o}=E(),t=R({storeCode:null,storeName:null,enableStorageLocation:0,materialCategory:null,isVirtual:0,isAllowNegativeStock:0,storeTypeCode:null,remark:null,storeGroupId:null}),c=g(),V=R({storeCode:x(o("storeArchives.storeCode")+o("cannot_empty")),storeName:x(o("storeArchives.storeName")+o("cannot_empty")),enableStorageLocation:x(o("storeArchives.enableStorageLocation")+o("cannot_empty")),isAllowNegativeStock:x(o("storeArchives.allowNegativeStock")+o("cannot_empty")),isVirtual:x(o("storeArchives.virtual")+o("cannot_empty")),storeGroupId:x(o("storeArchives.storeGroup")+o("cannot_empty")),materialCategory:x(o("storeArchives.materialCategory")+o("cannot_empty"))}),n=g(""),_=g(!1),d=g([]),w=async()=>new Promise(async(h,k)=>{if(!c.value){k(!1);return}try{await c.value.validate(),t.id?await Ae(t):await we(t),i(),pe({type:"success",message:o("operate_success")}),h(!0)}catch(S){throw k(S),S}}),y=g(!1),u=g(!1),A=async(h,k)=>{if(n.value=u.value?o("check_details"):h&&k?o("edit")+o("storeArchives.store"):o("add")+o("storeArchives.store"),_.value=!!(h&&k),T(),y.value=!0,t.isVirtual=0,t.isAllowNegativeStock=0,t.enableStorageLocation=0,k){const{data:S}=await Ve({id:k});for(let D in S)Object.prototype.hasOwnProperty.call(S,D)&&(t[D]=S[D])}},T=()=>{c.value&&(c.value.resetFields(),c.value.clearValidate());for(let h in t)t[h]=void 0},i=()=>{y.value=!1,u.value=!1,T(),d.value=[]};return{updateFormData:t,updateFormRef:c,updateFormRules:V,submit:w,showHandle:y,openHandle:A,closeHandle:i,title:n,disabled:_,handleCheckDetail:h=>{u.value=!0,A(h,h.id)},colorList:d,isDetails:u}}const L=g([]),j=g();function Fe(o,t){async function c(n){n.id||j.value;const _=L.value.length>0&&L.value.every(u=>u.disable),d=!L.value.length&&n.disable,w=async()=>{await Ne({id:n.id}),j.value="",L.value=[],t.$modal.msgSuccess(o("operate_success"))},y=u=>t.$modal.confirm(u).then(w);_?await y(o("delete_tip1")):L.value.length?await y(o("delete_tip2")):d?await y(o("delete_tip4")):await y(o("delete_tip3"))}function V({rowList:n}){L.value=n;const _=n.map(d=>d.id);j.value=_.join(",")}return{deleteHandler:c,select:V,idList:L}}const Ge={class:"app-container"},Ue={class:"dialog-footer"},$e=Object.assign({name:"StoreIndex"},{__name:"index",setup(o){const{t}=E(),{proxy:c}=ye(),{pageData:V}=ke(),{formData:n,tableData:_,loadData:d,searchFormRef:w,resetData:y,storeGroupOptions:u,materialCategoryOptions:A,getOption:T}=xe(),{updateFormData:i,updateFormRef:K,updateFormRules:h,submit:k,openHandle:S,showHandle:D,title:le,handleCheckDetail:oe,closeHandle:Q,isDetails:C}=Le(),{deleteHandler:se,select:re,idList:ze}=Fe(t,c),I=g(!0),ne=g("");me(()=>{d(),T()});const ie=async()=>{try{await k(),setTimeout(()=>{d()},50)}catch(O){throw O}},de=async O=>{await se(O),setTimeout(()=>{d()},50)};return(O,r)=>{const z=f("el-input"),v=f("el-form-item"),b=f("el-col"),ue=f("el-checkbox"),N=f("el-button"),$=f("el-row"),W=f("el-form"),B=f("el-tooltip"),H=f("el-tag"),J=f("el-option"),X=f("el-select"),F=f("el-radio"),M=f("el-radio-group"),ce=f("el-dialog");return G(),P("div",Ge,[fe(a(W,{model:e(n),ref_key:"searchFormRef",ref:w,inline:!0,labelSuffix:":"},{default:l(()=>[a($,{gutter:20},{default:l(()=>[a(b,{lg:4,sm:12,md:12,xs:24},{default:l(()=>[a(v,{label:e(t)("storeArchives.storeGroup"),prop:"storeName"},{default:l(()=>[a(z,{modelValue:e(n).storeName,"onUpdate:modelValue":r[0]||(r[0]=s=>e(n).storeName=s),placeholder:e(t)("input")+e(t)("storeArchives.storeGroup"),clearable:"",onKeyup:ge(e(d),["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1},8,["label"])]),_:1}),a(b,{lg:2,sm:12,md:12,xs:24},{default:l(()=>[a(v,{label:"",prop:"delFlag"},{default:l(()=>[a(ue,{modelValue:e(n).disable,"onUpdate:modelValue":r[1]||(r[1]=s=>e(n).disable=s),onChange:e(d),"true-label":1,"false-label":0,label:e(t)("include_disable"),size:"large"},null,8,["modelValue","onChange","label"])]),_:1})]),_:1}),a(b,{lg:4,sm:12,md:12,xs:24},{default:l(()=>[a(v,null,{default:l(()=>[a(N,{type:"primary",icon:"Search",onClick:e(d)},{default:l(()=>[p(m(e(t)("query")),1)]),_:1},8,["onClick"]),a(N,{icon:"Refresh",onClick:e(y)},{default:l(()=>[p(m(e(t)("reset")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),[[be,e(I)]]),a($,{gutter:10,class:"mb10 mt10"},{default:l(()=>[a(b,{span:1.5},{default:l(()=>[a(N,{type:"primary",plain:"",icon:"Plus",onClick:e(S)},{default:l(()=>[p(m(e(t)("add")),1)]),_:1},8,["onClick"])]),_:1})]),_:1}),a(he,{loading:e(Z)().loading,onSelect:e(re),ref_key:"tableRef",ref:ne,onQueryTable:e(d),showSearch:e(I),"onUpdate:showSearch":r[2]||(r[2]=s=>ee(I)?I.value=s:null),"table-key":"storeId",onHandleCurrentChange:e(d),total:e(_).total,showMultipleColumn:"",pageSize:e(n).pageSize,"onUpdate:pageSize":r[3]||(r[3]=s=>e(n).pageSize=s),pageNum:e(n).pageNum,"onUpdate:pageNum":r[4]||(r[4]=s=>e(n).pageNum=s),operateWidth:"100px",tableData:e(_).list,columnData:e(V).columnData,showSummary:!1,showOperate:!1,"show-multiple":!1,"show-multiple-column":!0,showPagination:!0},{operateDefault:l(({data:{row:s}})=>[a(B,{class:"box-item",effect:"dark",content:e(t)("check_details"),placement:"top-start"},{default:l(()=>[a(N,{link:"",type:"primary",icon:"View",onClick:Y=>e(oe)(s)},null,8,["onClick"])]),_:2},1032,["content"]),a(B,{class:"box-item",effect:"dark",content:e(t)("edit"),placement:"top-start"},{default:l(()=>[a(N,{link:"",type:"primary",icon:"Edit",disabled:s.notEdit,onClick:Y=>e(S)(s,s.id)},null,8,["disabled","onClick"])]),_:2},1032,["content"]),a(B,{class:"box-item",effect:"dark",content:e(t)("delete"),placement:"top-start"},{default:l(()=>[a(N,{link:"",type:"primary",icon:"Delete",disabled:s.notDelete,onClick:Y=>de(s)},null,8,["disabled","onClick"])]),_:2},1032,["content"])]),enableStorageLocationDefault:l(({data:{row:s}})=>[a(H,{type:s.enableStorageLocation?"success":"info"},{default:l(()=>[p(m(s.enableStorageLocation?e(t)("storeArchives.enable"):e(t)("storeArchives.not_enabled")),1)]),_:2},1032,["type"])]),isAllowNegativeStockDefault:l(({data:{row:s}})=>[a(H,{type:s.isAllowNegativeStock?"success":"info"},{default:l(()=>[p(m(s.isAllowNegativeStock?e(t)("yes"):e(t)("no")),1)]),_:2},1032,["type"])]),isVirtualDefault:l(({data:{row:s}})=>[a(H,{type:s.isVirtual?"success":"info"},{default:l(()=>[p(m(s.isVirtual?e(t)("yes"):e(t)("no")),1)]),_:2},1032,["type"])]),disableDefault:l(({data:{row:s}})=>[a(H,{type:s.disable?"info":"success"},{default:l(()=>[p(m(s.disable?e(t)("disabled"):e(t)("normal")),1)]),_:2},1032,["type"])]),_:1},8,["loading","onSelect","onQueryTable","showSearch","onHandleCurrentChange","total","pageSize","pageNum","tableData","columnData"]),a(ce,{title:e(le),modelValue:e(D),"onUpdate:modelValue":r[14]||(r[14]=s=>ee(D)?D.value=s:null),width:"500px","append-to-body":"",onClose:e(Q)},{footer:l(()=>[_e("div",Ue,[e(C)?ve("",!0):(G(),q(N,{key:0,type:"primary",class:"btn-confirm",loading:e(Z)().loading,onClick:ie},{default:l(()=>[p(m(e(t)("confirm")),1)]),_:1},8,["loading"])),a(N,{class:"btn-cancel",onClick:e(Q)},{default:l(()=>[p(m(e(C)?e(t)("close"):e(t)("cancel")),1)]),_:1},8,["onClick"])])]),default:l(()=>[a(W,{ref_key:"updateFormRef",ref:K,"label-position":"left",model:e(i),rules:e(h),"label-suffix":"ï¼š"},{default:l(()=>[a($,{gutter:20},{default:l(()=>[a(b,{span:24},{default:l(()=>[a(v,{label:e(t)("storeArchives.storeGroup"),prop:"storeGroupId"},{default:l(()=>[a(X,{modelValue:e(i).storeGroupId,"onUpdate:modelValue":r[5]||(r[5]=s=>e(i).storeGroupId=s),clearable:"",disabled:e(C)},{default:l(()=>[(G(!0),P(te,null,ae(e(u),s=>(G(),q(J,{key:s.id,label:s.groupName,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["label"])]),_:1}),a(b,{span:24},{default:l(()=>[a(v,{label:e(t)("storeArchives.materialCategory"),prop:"materialCategory"},{default:l(()=>[a(X,{modelValue:e(i).materialCategory,"onUpdate:modelValue":r[6]||(r[6]=s=>e(i).materialCategory=s),clearable:"",disabled:e(C)},{default:l(()=>[(G(!0),P(te,null,ae(e(A),s=>(G(),q(J,{key:s.materialCategory,label:s.materialCategoryName,value:s.materialCategory},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["label"])]),_:1}),a(b,{span:24},{default:l(()=>[a(v,{label:e(t)("storeArchives.storeCode"),prop:"storeCode"},{default:l(()=>[a(z,{modelValue:e(i).storeCode,"onUpdate:modelValue":r[7]||(r[7]=s=>e(i).storeCode=s),disabled:e(C),placeholder:e(t)("input")+e(t)("storeArchives.storeCode")},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])]),_:1}),a(b,{span:24},{default:l(()=>[a(v,{label:e(t)("storeArchives.storeName"),prop:"storeName"},{default:l(()=>[a(z,{modelValue:e(i).storeName,"onUpdate:modelValue":r[8]||(r[8]=s=>e(i).storeName=s),disabled:e(C),placeholder:e(t)("input")+e(t)("storeArchives.storeName")},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])]),_:1}),a(b,{span:24},{default:l(()=>[a(v,{label:e(t)("storeArchives.enableStorageLocation"),prop:"enableStorageLocation"},{default:l(()=>[a(M,{modelValue:e(i).enableStorageLocation,"onUpdate:modelValue":r[9]||(r[9]=s=>e(i).enableStorageLocation=s),class:"ml-4",disabled:e(C)},{default:l(()=>[a(F,{value:1,label:1,size:"small"},{default:l(()=>[p(m(e(t)("storeArchives.enable")),1)]),_:1}),a(F,{value:0,label:0,size:"small"},{default:l(()=>[p(m(e(t)("storeArchives.not_enabled")),1)]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1},8,["label"])]),_:1}),a(b,{span:24},{default:l(()=>[a(v,{label:e(t)("storeArchives.allowNegativeStock"),prop:"isAllowNegativeStock"},{default:l(()=>[a(M,{modelValue:e(i).isAllowNegativeStock,"onUpdate:modelValue":r[10]||(r[10]=s=>e(i).isAllowNegativeStock=s),class:"ml-4",disabled:e(C)},{default:l(()=>[a(F,{value:1,label:1,size:"small"},{default:l(()=>[p(m(e(t)("yes")),1)]),_:1}),a(F,{value:0,label:0,size:"small"},{default:l(()=>[p(m(e(t)("no")),1)]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1},8,["label"])]),_:1}),a(b,{span:24},{default:l(()=>[a(v,{label:e(t)("storeArchives.virtual"),prop:"isVirtual"},{default:l(()=>[a(M,{modelValue:e(i).isVirtual,"onUpdate:modelValue":r[11]||(r[11]=s=>e(i).isVirtual=s),class:"ml-4",disabled:e(C)},{default:l(()=>[a(F,{value:1,label:1,size:"small"},{default:l(()=>[p(m(e(t)("yes")),1)]),_:1}),a(F,{value:0,label:0,size:"small"},{default:l(()=>[p(m(e(t)("no")),1)]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1},8,["label"])]),_:1}),a(b,{span:24},{default:l(()=>[a(v,{label:e(t)("storeArchives.storeTypeCode"),prop:"storeTypeCode"},{default:l(()=>[a(z,{modelValue:e(i).storeTypeCode,"onUpdate:modelValue":r[12]||(r[12]=s=>e(i).storeTypeCode=s),disabled:e(C),placeholder:e(t)("input")+e(t)("storeArchives.storeTypeCode")},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])]),_:1}),a(b,{span:24},{default:l(()=>[a(v,{label:e(t)("remark"),prop:"remark"},{default:l(()=>[a(z,{modelValue:e(i).remark,"onUpdate:modelValue":r[13]||(r[13]=s=>e(i).remark=s),type:"textarea",clearable:"",disabled:e(C),placeholder:`${e(t)("input")}${e(t)("remark")} `},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onClose"])])}}});export{$e as default};
