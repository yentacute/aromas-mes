import{b as T,e as S,r as b,W as se,f as re,h as p,o as U,c as E,L as de,M as ie,k as e,i as t,j as o,p as ue,x as A,t as x,$ as M,I as K,n as ce,s as L,v as pe,F as me,q as fe,z as be}from"./index-BP30Yz_m.js";import{C as _e}from"./index-DTWQQqpJ.js";import{b as he}from"./warehouse-DqhAX_t8.js";import{l as ge,u as ye,a as we,g as ke,d as Ce}from"./warehouseArea-Ck7-7bct.js";import{r as W}from"./verify-D2E6NcQX.js";function ve(){const{t:l}=T();return{pageData:S({columnData:[{label:l("storeArea.warehouseName"),prop:"warehouseName",width:"150",fixed:"left"},{label:l("storeArea.areaName"),prop:"areaName",width:"auto",fixed:"left"},{label:l("storeArea.areaCode"),prop:"areaCode",width:"auto",fixed:"left"},{label:l("is_disable"),prop:"disable",width:"auto"},{label:l("remark"),prop:"remark",width:"auto"},{label:l("operate"),prop:"operate",width:"150",fixed:"right"}]})}}function De(){const l=S({pageSize:10,pageNum:1,areaName:null,disable:0}),a=S({list:[],total:0}),u=b(),y=b([]),s=()=>{l.pageNum=1,l.pageSize=10,l.disable=0},m=()=>{u.value&&(u.value.resetFields(),u.value.clearValidate());for(const d in l)Object.prototype.hasOwnProperty.call(l,d)&&(l[d]=void 0);s(),i()},i=async()=>{const{rows:d,total:_}=await ge(l);a.list=d,a.total=_};return{formData:l,loadData:i,searchFormRef:u,resetData:m,tableData:a,reloadData:s,warehouseOptions:y,getOption:async()=>{const{data:d}=await he();y.value=d}}}function Ne(){const{t:l}=T(),a=S({areaCode:null,areaName:null,warehouseId:null,remark:null}),u=b(),y=S({areaCode:W(l("storeArea.areaCode")+l("cannot_empty")),areaName:W(l("storeArea.areaName")+l("cannot_empty")),warehouseId:W(l("storeArea.warehouseName")+l("cannot_empty"))}),s=b(""),m=b(!1),i=async()=>new Promise(async(f,h)=>{if(!u.value){h(!1);return}try{await u.value.validate(),a.id?await ye(a):await we(a),c(),se({type:"success",message:l("operate_success")}),f(!0)}catch(g){throw h(g),g}}),w=b(!1),d=b(!1),_=async(f,h)=>{if(s.value=d.value?l("check_details"):f&&h?l("edit")+l("storeArea.warehouseArea"):l("add")+l("storeArea.warehouseArea"),m.value=!!(f&&h),F(),w.value=!0,h){const{data:g}=await ke({id:h});for(let v in g)Object.prototype.hasOwnProperty.call(g,v)&&(a[v]=g[v])}},F=()=>{u.value&&(u.value.resetFields(),u.value.clearValidate());for(let f in a)a[f]=void 0},c=()=>{w.value=!1,d.value=!1,F()};return{updateFormData:a,updateFormRef:u,updateFormRules:y,submit:i,showHandle:w,openHandle:_,closeHandle:c,title:s,disabled:m,handleCheckDetail:f=>{d.value=!0,_(f,f.id)},isDetails:d}}const N=b([]),$=b();function Ve(l,a){async function u(s){s.id||$.value;const m=N.value.length>0&&N.value.every(_=>_.disable),i=!N.value.length&&s.disable,w=async()=>{await Ce({id:s.id}),$.value="",N.value=[],a.$modal.msgSuccess(l("operate_success"))},d=_=>a.$modal.confirm(_).then(w);m?await d(l("delete_tip1")):N.value.length?await d(l("delete_tip2")):i?await d(l("delete_tip4")):await d(l("delete_tip3"))}function y({rowList:s}){N.value=s;const m=s.map(i=>i.id);$.value=m.join(",")}return{deleteHandler:u,select:y,idList:N}}const Ae={class:"app-container"},xe={class:"dialog-footer"},Ue=Object.assign({name:"warehouseArea"},{__name:"index",setup(l){const{t:a}=T(),{proxy:u}=be(),{pageData:y}=ve(),{formData:s,tableData:m,loadData:i,searchFormRef:w,resetData:d,warehouseOptions:_,getOption:F}=De(),{updateFormData:c,updateFormRef:B,updateFormRules:f,submit:h,openHandle:g,showHandle:v,title:Q,handleCheckDetail:G,closeHandle:P,isDetails:V}=Ne(),{deleteHandler:J,select:X}=Ve(a,u),R=b(!0),Y=b("");re(()=>{i(),F()});const Z=async()=>{try{await h(),setTimeout(()=>{i()},50)}catch(I){throw I}},ee=async I=>{await J(I),setTimeout(()=>{i()},50)};return(I,r)=>{const O=p("el-input"),D=p("el-form-item"),k=p("el-col"),ae=p("el-checkbox"),C=p("el-button"),H=p("el-row"),j=p("el-form"),z=p("el-tooltip"),te=p("el-tag"),le=p("el-option"),oe=p("el-select"),ne=p("el-dialog");return U(),E("div",Ae,[de(t(j,{model:e(s),ref_key:"searchFormRef",ref:w,inline:!0,labelSuffix:":"},{default:o(()=>[t(H,{gutter:20},{default:o(()=>[t(k,{lg:6,sm:12,md:12,xs:24},{default:o(()=>[t(D,{label:e(a)("storeArea.areaName"),prop:"areaName"},{default:o(()=>[t(O,{modelValue:e(s).areaName,"onUpdate:modelValue":r[0]||(r[0]=n=>e(s).areaName=n),placeholder:e(a)("storeArea.areaName"),clearable:"",onKeyup:ue(e(i),["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1},8,["label"])]),_:1}),t(k,{lg:2,sm:12,md:12,xs:24},{default:o(()=>[t(D,{label:"",prop:"disable"},{default:o(()=>[t(ae,{modelValue:e(s).disable,"onUpdate:modelValue":r[1]||(r[1]=n=>e(s).disable=n),onChange:e(i),"true-label":1,"false-label":0,label:e(a)("include_disable"),size:"large"},null,8,["modelValue","onChange","label"])]),_:1})]),_:1}),t(k,{lg:4,sm:12,md:12,xs:24},{default:o(()=>[t(D,null,{default:o(()=>[t(C,{type:"primary",icon:"Search",onClick:e(i)},{default:o(()=>[A(x(e(a)("query")),1)]),_:1},8,["onClick"]),t(C,{icon:"Refresh",onClick:e(d)},{default:o(()=>[A(x(e(a)("reset")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),[[ie,e(R)]]),t(H,{gutter:10,class:"mb10 mt10"},{default:o(()=>[t(k,{span:1.5},{default:o(()=>[t(C,{type:"primary",plain:"",icon:"Plus",onClick:e(g)},{default:o(()=>[A(x(e(a)("add")),1)]),_:1},8,["onClick"])]),_:1})]),_:1}),t(_e,{loading:e(M)().loading,onSelect:e(X),ref_key:"tableRef",ref:Y,onQueryTable:e(i),showSearch:e(R),"onUpdate:showSearch":r[2]||(r[2]=n=>K(R)?R.value=n:null),"table-key":"warehouseAreaId",onHandleCurrentChange:e(i),total:e(m).total,showMultipleColumn:"",pageSize:e(s).pageSize,"onUpdate:pageSize":r[3]||(r[3]=n=>e(s).pageSize=n),pageNum:e(s).pageNum,"onUpdate:pageNum":r[4]||(r[4]=n=>e(s).pageNum=n),operateWidth:"100px",tableData:e(m).list,columnData:e(y).columnData,showSummary:!1,showOperate:!1,"show-multiple":!1,"show-multiple-column":!0,showPagination:!0},{operateDefault:o(({data:{row:n}})=>[t(z,{class:"box-item",effect:"dark",content:e(a)("check_details"),placement:"top-start"},{default:o(()=>[t(C,{link:"",type:"primary",icon:"View",onClick:q=>e(G)(n)},null,8,["onClick"])]),_:2},1032,["content"]),t(z,{class:"box-item",effect:"dark",content:e(a)("edit"),placement:"top-start"},{default:o(()=>[t(C,{link:"",type:"primary",icon:"Edit",disabled:n.notEdit,onClick:q=>e(g)(n,n.id)},null,8,["disabled","onClick"])]),_:2},1032,["content"]),t(z,{class:"box-item",effect:"dark",content:e(a)("delete"),placement:"top-start"},{default:o(()=>[t(C,{link:"",type:"primary",icon:"Delete",disabled:n.notDelete,onClick:q=>ee(n)},null,8,["disabled","onClick"])]),_:2},1032,["content"])]),disableDefault:o(({data:{row:n}})=>[t(te,{type:n.disable?"info":"success"},{default:o(()=>[A(x(n.disable?e(a)("disabled"):e(a)("normal")),1)]),_:2},1032,["type"])]),_:1},8,["loading","onSelect","onQueryTable","showSearch","onHandleCurrentChange","total","pageSize","pageNum","tableData","columnData"]),t(ne,{title:e(Q),modelValue:e(v),"onUpdate:modelValue":r[9]||(r[9]=n=>K(v)?v.value=n:null),width:"500px","append-to-body":"",onClose:e(P)},{footer:o(()=>[ce("div",xe,[e(V)?pe("",!0):(U(),L(C,{key:0,type:"primary",class:"btn-confirm",loading:e(M)().loading,onClick:Z},{default:o(()=>[A(x(e(a)("confirm")),1)]),_:1},8,["loading"])),t(C,{class:"btn-cancel",onClick:e(P)},{default:o(()=>[A(x(e(V)?e(a)("close"):e(a)("cancel")),1)]),_:1},8,["onClick"])])]),default:o(()=>[t(j,{ref_key:"updateFormRef",ref:B,"label-position":"left",model:e(c),rules:e(f),"label-suffix":"ï¼š"},{default:o(()=>[t(H,{gutter:20},{default:o(()=>[t(k,{span:24},{default:o(()=>[t(D,{label:e(a)("storeArea.warehouseName"),prop:"warehouseId"},{default:o(()=>[t(oe,{modelValue:e(c).warehouseId,"onUpdate:modelValue":r[5]||(r[5]=n=>e(c).warehouseId=n),clearable:"",disabled:e(V)},{default:o(()=>[(U(!0),E(me,null,fe(e(_),n=>(U(),L(le,{key:n.id,label:n.warehouseName,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["label"])]),_:1}),t(k,{span:24},{default:o(()=>[t(D,{label:e(a)("storeArea.areaCode"),prop:"areaCode"},{default:o(()=>[t(O,{modelValue:e(c).areaCode,"onUpdate:modelValue":r[6]||(r[6]=n=>e(c).areaCode=n),disabled:e(V),placeholder:e(a)("input")+e(a)("storeArea.areaCode")},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])]),_:1}),t(k,{span:24},{default:o(()=>[t(D,{label:e(a)("storeArea.areaName"),prop:"areaName"},{default:o(()=>[t(O,{modelValue:e(c).areaName,"onUpdate:modelValue":r[7]||(r[7]=n=>e(c).areaName=n),disabled:e(V),placeholder:e(a)("input")+e(a)("storeArea.areaName")},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])]),_:1}),t(k,{span:24},{default:o(()=>[t(D,{label:e(a)("remark"),prop:"remark"},{default:o(()=>[t(O,{modelValue:e(c).remark,"onUpdate:modelValue":r[8]||(r[8]=n=>e(c).remark=n),type:"textarea",clearable:"",disabled:e(V),placeholder:`${e(a)("input")}${e(a)("remark")} `},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onClose"])])}}});export{Ue as default};
